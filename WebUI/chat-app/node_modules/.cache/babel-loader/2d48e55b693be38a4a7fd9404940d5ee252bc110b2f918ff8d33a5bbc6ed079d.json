{"ast":null,"code":"'use strict';\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n    r,\n    ar = [],\n    e;\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n  return ar;\n};\nvar __spreadArray = this && this.__spreadArray || function (to, from) {\n  for (var i = 0, il = from.length, j = to.length; i < il; i++, j++) to[j] = from[i];\n  return to;\n};\nvar constants = require('./constants');\nvar E = constants.typeErrors,\n  trackPriority = constants.trackPriority;\nvar util = require('../webrtc/util');\nvar sessionSID = require('./sid').sessionSID;\nvar TwilioWarning = require('./twiliowarning');\n/**\n * Return the given {@link LocalTrack} or a new {@link LocalTrack} for the\n * given MediaStreamTrack.\n * @param {LocalTrack|MediaStreamTrack} track\n * @param {object} options\n * @returns {LocalTrack}\n * @throws {TypeError}\n */\nfunction asLocalTrack(track, options) {\n  if (track instanceof options.LocalAudioTrack || track instanceof options.LocalVideoTrack || track instanceof options.LocalDataTrack) {\n    return track;\n  }\n  if (track instanceof options.MediaStreamTrack) {\n    return track.kind === 'audio' ? new options.LocalAudioTrack(track, options) : new options.LocalVideoTrack(track, options);\n  }\n  /* eslint new-cap:0 */\n  throw E.INVALID_TYPE('track', 'LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack');\n}\n/**\n * Create a new {@link LocalTrackPublication} for the given {@link LocalTrack}.\n * @param {LocalTrack} track\n * @param {LocalTrackPublicationSignaling} signaling\n * @param {function(track: LocalTrackPublication): void} unpublish\n * @param {object} options\n */\nfunction asLocalTrackPublication(track, signaling, unpublish, options) {\n  var LocalTrackPublication = {\n    audio: options.LocalAudioTrackPublication,\n    video: options.LocalVideoTrackPublication,\n    data: options.LocalDataTrackPublication\n  }[track.kind];\n  return new LocalTrackPublication(signaling, track, unpublish, options);\n}\n/**\n * Capitalize a word.\n * @param {string} word\n * @returns {string} capitalized\n */\nfunction capitalize(word) {\n  return word[0].toUpperCase() + word.slice(1);\n}\n/**\n * Log deprecation warnings for the given events of an EventEmitter.\n * @param {string} name\n * @param {EventEmitter} emitter\n * @param {Map<string, string>} events\n * @param {Log} log\n */\nfunction deprecateEvents(name, emitter, events, log) {\n  var warningsShown = new Set();\n  emitter.on('newListener', function newListener(event) {\n    if (events.has(event) && !warningsShown.has(event)) {\n      log.deprecated(name + \"#\" + event + \" has been deprecated and scheduled for removal in twilio-video.js@2.0.0.\" + (events.get(event) ? \" Use \" + name + \"#\" + events.get(event) + \" instead.\" : ''));\n      warningsShown.add(event);\n    }\n    if (warningsShown.size >= events.size) {\n      emitter.removeListener('newListener', newListener);\n    }\n  });\n}\n/**\n * Finds the items in list1 that are not in list2.\n * @param {Array<*>|Map<*>|Set<*>} list1\n * @param {Array<*>|Map<*>|Set<*>} list2\n * @returns {Set}\n */\nfunction difference(list1, list2) {\n  list1 = Array.isArray(list1) ? new Set(list1) : new Set(list1.values());\n  list2 = Array.isArray(list2) ? new Set(list2) : new Set(list2.values());\n  var difference = new Set();\n  list1.forEach(function (item) {\n    if (!list2.has(item)) {\n      difference.add(item);\n    }\n  });\n  return difference;\n}\n/**\n * Filter out the keys in an object with a given value.\n * @param {object} object - Object to be filtered\n * @param {*} [filterValue] - Value to be filtered out; If not specified, then\n *   filters out all keys which have an explicit value of \"undefined\"\n * @returns {object} - Filtered object\n */\nfunction filterObject(object, filterValue) {\n  return Object.keys(object).reduce(function (filtered, key) {\n    if (object[key] !== filterValue) {\n      filtered[key] = object[key];\n    }\n    return filtered;\n  }, {});\n}\n/**\n * Map a list to an array of arrays, and return the flattened result.\n * @param {Array<*>|Set<*>|Map<*>} list\n * @param {function(*): Array<*>} [mapFn]\n * @returns Array<*>\n */\nfunction flatMap(list, mapFn) {\n  var listArray = list instanceof Map || list instanceof Set ? Array.from(list.values()) : list;\n  mapFn = mapFn || function mapFn(item) {\n    return item;\n  };\n  return listArray.reduce(function (flattened, item) {\n    var mapped = mapFn(item);\n    return flattened.concat(mapped);\n  }, []);\n}\n/**\n * Get the user agent string, or return \"Unknown\".\n * @returns {string}\n */\nfunction getUserAgent() {\n  return typeof navigator !== 'undefined' && navigator.userAgent ? navigator.userAgent : 'Unknown';\n}\n/**\n * Get the platform component of the user agent string.\n * Example:\n *   Input - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36\n *   Output - macintosh\n * @returns {string}\n */\nfunction getPlatform() {\n  var userAgent = getUserAgent();\n  var _a = __read(userAgent.match(/\\(([^)]+)\\)/) || [], 2),\n    _b = _a[1],\n    match = _b === void 0 ? 'unknown' : _b;\n  var _c = __read(match.split(';').map(function (entry) {\n      return entry.trim();\n    }), 1),\n    platform = _c[0];\n  return platform.toLowerCase();\n}\n/**\n * Create a unique identifier.\n * @returns {string}\n */\nfunction makeUUID() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0;\n    var v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}\n/**\n * Ensure that the given function is called once per tick.\n * @param {function} fn - Function to be executed\n * @returns {function} - Schedules the given function to be called on the next tick\n */\nfunction oncePerTick(fn) {\n  var timeout = null;\n  function nextTick() {\n    timeout = null;\n    fn();\n  }\n  return function scheduleNextTick() {\n    if (timeout) {\n      clearTimeout(timeout);\n    }\n    timeout = setTimeout(nextTick);\n  };\n}\nfunction promiseFromEvents(operation, eventEmitter, successEvent, failureEvent) {\n  return new Promise(function (resolve, reject) {\n    function onSuccess() {\n      var args = [].slice.call(arguments);\n      if (failureEvent) {\n        eventEmitter.removeListener(failureEvent, onFailure);\n      }\n      resolve.apply(void 0, __spreadArray([], __read(args)));\n    }\n    function onFailure() {\n      var args = [].slice.call(arguments);\n      eventEmitter.removeListener(successEvent, onSuccess);\n      reject.apply(void 0, __spreadArray([], __read(args)));\n    }\n    eventEmitter.once(successEvent, onSuccess);\n    if (failureEvent) {\n      eventEmitter.once(failureEvent, onFailure);\n    }\n    operation();\n  });\n}\n/**\n * Traverse down multiple nodes on an object and return null if\n * any link in the path is unavailable.\n * @param {Object} obj - Object to traverse\n * @param {String} path - Path to traverse. Period-separated.\n * @returns {Any|null}\n */\nfunction getOrNull(obj, path) {\n  return path.split('.').reduce(function (output, step) {\n    if (!output) {\n      return null;\n    }\n    return output[step];\n  }, obj);\n}\n/**\n * @typedef {object} Deferred\n * @property {Promise} promise\n * @property {function} reject\n * @property {function} resolve\n */\n/**\n * Create a {@link Deferred}.\n * @returns {Deferred}\n */\nfunction defer() {\n  var deferred = {};\n  deferred.promise = new Promise(function (resolve, reject) {\n    deferred.resolve = resolve;\n    deferred.reject = reject;\n  });\n  return deferred;\n}\n/**\n * Copy a method from a `source` prototype onto a `wrapper` prototype. Invoking\n * the method on the `wrapper` prototype will invoke the corresponding method\n * on an instance accessed by `target`.\n * @param {object} source\n * @param {object} wrapper\n * @param {string} target\n * @param {string} methodName\n * @returns {undefined}\n */\nfunction delegateMethod(source, wrapper, target, methodName) {\n  if (methodName in wrapper) {\n    // Skip any methods already set.\n    return;\n  } else if (methodName.match(/^on[a-z]+$/)) {\n    // Skip EventHandlers (these are handled in the constructor).\n    return;\n  }\n  var type;\n  try {\n    type = typeof source[methodName];\n  } catch (error) {\n    // NOTE(mroberts): Attempting to check the type of non-function members\n    // on the prototype throws an error for some types.\n  }\n  if (type !== 'function') {\n    // Skip non-function members.\n    return;\n  }\n  /* eslint no-loop-func:0 */\n  wrapper[methodName] = function () {\n    var _a;\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n    return (_a = this[target])[methodName].apply(_a, __spreadArray([], __read(args)));\n  };\n}\n/**\n * Copy methods from a `source` prototype onto a `wrapper` prototype. Invoking\n * the methods on the `wrapper` prototype will invoke the corresponding method\n * on an instance accessed by `target`.\n * @param {object} source\n * @param {object} wrapper\n * @param {string} target\n * @returns {undefined}\n */\nfunction delegateMethods(source, wrapper, target) {\n  for (var methodName in source) {\n    delegateMethod(source, wrapper, target, methodName);\n  }\n}\n/**\n * Determine whether two values are deeply equal.\n * @param {*} val1\n * @param {*} val2\n * @returns {boolean}\n */\nfunction isDeepEqual(val1, val2) {\n  if (val1 === val2) {\n    return true;\n  }\n  if (typeof val1 !== typeof val2) {\n    return false;\n  }\n  if (val1 === null) {\n    return val2 === null;\n  }\n  if (val2 === null) {\n    return false;\n  }\n  if (Array.isArray(val1)) {\n    return Array.isArray(val2) && val1.length === val2.length && val1.every(function (val, i) {\n      return isDeepEqual(val, val2[i]);\n    });\n  }\n  if (typeof val1 === 'object') {\n    var val1Keys = Object.keys(val1).sort();\n    var val2Keys = Object.keys(val2).sort();\n    return !Array.isArray(val2) && isDeepEqual(val1Keys, val2Keys) && val1Keys.every(function (key) {\n      return isDeepEqual(val1[key], val2[key]);\n    });\n  }\n  return false;\n}\n/**\n * Whether the given argument is a non-array object.\n * @param {*} object\n * @return {boolean}\n */\nfunction isNonArrayObject(object) {\n  return typeof object === 'object' && !Array.isArray(object);\n}\n/**\n * For each property name on the `source` prototype, add getters and/or setters\n * to `wrapper` that proxy to `target`.\n * @param {object} source\n * @param {object} wrapper\n * @param {string} target\n * @returns {undefined}\n */\nfunction proxyProperties(source, wrapper, target) {\n  Object.getOwnPropertyNames(source).forEach(function (propertyName) {\n    proxyProperty(source, wrapper, target, propertyName);\n  });\n}\n/**\n * For the property name on the `source` prototype, add a getter and/or setter\n * to `wrapper` that proxies to `target`.\n * @param {object} source\n * @param {object} wrapper\n * @param {string} target\n * @param {string} propertyName\n * @returns {undefined}\n */\nfunction proxyProperty(source, wrapper, target, propertyName) {\n  if (propertyName in wrapper) {\n    // Skip any properties already set.\n    return;\n  } else if (propertyName.match(/^on[a-z]+$/)) {\n    Object.defineProperty(wrapper, propertyName, {\n      value: null,\n      writable: true\n    });\n    target.addEventListener(propertyName.slice(2), function () {\n      var args = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n      wrapper.dispatchEvent.apply(wrapper, __spreadArray([], __read(args)));\n    });\n    return;\n  }\n  Object.defineProperty(wrapper, propertyName, {\n    enumerable: true,\n    get: function () {\n      return target[propertyName];\n    }\n  });\n}\n/**\n * This is a function for turning a Promise into the kind referenced in the\n * Legacy Interface Extensions section of the WebRTC spec.\n * @param {Promise<*>} promise\n * @param {function<*>} onSuccess\n * @param {function<Error>} onFailure\n * @returns {Promise<undefined>}\n */\nfunction legacyPromise(promise, onSuccess, onFailure) {\n  if (onSuccess) {\n    return promise.then(function (result) {\n      onSuccess(result);\n    }, function (error) {\n      onFailure(error);\n    });\n  }\n  return promise;\n}\n/**\n * Build the {@link LogLevels} object.\n * @param {String|LogLevel} logLevel - Log level name or object\n * @returns {LogLevels}\n */\nfunction buildLogLevels(logLevel) {\n  if (typeof logLevel === 'string') {\n    return {\n      default: logLevel,\n      media: logLevel,\n      signaling: logLevel,\n      webrtc: logLevel\n    };\n  }\n  return logLevel;\n}\n/**\n * Get the {@link Track}'s derived class name\n * @param {Track} track\n * @param {?boolean} [local=undefined]\n * @returns {string}\n */\nfunction trackClass(track, local) {\n  local = local ? 'Local' : '';\n  return local + (track.kind || '').replace(/\\w{1}/, function (m) {\n    return m.toUpperCase();\n  }) + \"Track\";\n}\n/**\n * Get the {@link TrackPublication}'s derived class name\n * @param {TrackPublication} publication\n * @param {?boolean} [local=undefined]\n * @returns {string}\n */\nfunction trackPublicationClass(publication, local) {\n  local = local ? 'Local' : '';\n  return local + (publication.kind || '').replace(/\\w{1}/, function (m) {\n    return m.toUpperCase();\n  }) + \"TrackPublication\";\n}\n/**\n * Sets all underscore-prefixed properties on `object` non-enumerable.\n * @param {Object} object\n * @returns {void}\n */\nfunction hidePrivateProperties(object) {\n  Object.getOwnPropertyNames(object).forEach(function (name) {\n    if (name.startsWith('_')) {\n      hideProperty(object, name);\n    }\n  });\n}\n/**\n * Creates a new subclass which, in the constructor, sets all underscore-prefixed\n * properties and the given public properties non-enumerable. This is useful for\n * patching up classes like EventEmitter which may set properties like `_events`\n * and `domain`.\n * @param {Function} klass\n * @param {Array<string>} props\n * @returns {Function} subclass\n */\nfunction hidePrivateAndCertainPublicPropertiesInClass(klass, props) {\n  // NOTE(mroberts): We do this to avoid giving the class a name.\n  return (/** @class */function (_super) {\n      __extends(class_1, _super);\n      function class_1() {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        var _this = _super.apply(this, __spreadArray([], __read(args))) || this;\n        hidePrivateProperties(_this);\n        hidePublicProperties(_this, props);\n        return _this;\n      }\n      return class_1;\n    }(klass)\n  );\n}\n/**\n * Hide a property of an object.\n * @param {object} object\n * @param {string} name\n */\nfunction hideProperty(object, name) {\n  var descriptor = Object.getOwnPropertyDescriptor(object, name);\n  descriptor.enumerable = false;\n  Object.defineProperty(object, name, descriptor);\n}\n/**\n * Hide the given public properties of an object.\n * @param {object} object\n * @param {Array<string>} [props=[]]\n */\nfunction hidePublicProperties(object, props) {\n  if (props === void 0) {\n    props = [];\n  }\n  props.forEach(function (name) {\n    // eslint-disable-next-line no-prototype-builtins\n    if (object.hasOwnProperty(name)) {\n      hideProperty(object, name);\n    }\n  });\n}\n/**\n * Convert an Array of values to an Array of JSON values by calling\n * `valueToJSON` on each value.\n * @param {Array<*>} array\n * @returns {Array<*>}\n */\nfunction arrayToJSON(array) {\n  return array.map(valueToJSON);\n}\n/**\n * Convert a Set of values to an Array of JSON values by calling `valueToJSON`\n * on each value.\n * @param {Set<*>} set\n * @returns {Array<*>}\n */\nfunction setToJSON(set) {\n  return arrayToJSON(__spreadArray([], __read(set)));\n}\n/**\n * Convert a Map from strings to values to an object of JSON values by calling\n * `valueToJSON` on each value.\n * @param {Map<string, *>} map\n * @returns {object}\n */\nfunction mapToJSON(map) {\n  return __spreadArray([], __read(map.entries())).reduce(function (json, _a) {\n    var _b;\n    var _c = __read(_a, 2),\n      key = _c[0],\n      value = _c[1];\n    return Object.assign((_b = {}, _b[key] = valueToJSON(value), _b), json);\n  }, {});\n}\n/**\n * Convert an object to a JSON value by calling `valueToJSON` on its enumerable\n * keys.\n * @param {object} object\n * @returns {object}\n */\nfunction objectToJSON(object) {\n  return Object.entries(object).reduce(function (json, _a) {\n    var _b;\n    var _c = __read(_a, 2),\n      key = _c[0],\n      value = _c[1];\n    return Object.assign((_b = {}, _b[key] = valueToJSON(value), _b), json);\n  }, {});\n}\n/**\n * Convert a value into a JSON value.\n * @param {*} value\n * @returns {*}\n */\nfunction valueToJSON(value) {\n  if (Array.isArray(value)) {\n    return arrayToJSON(value);\n  } else if (value instanceof Set) {\n    return setToJSON(value);\n  } else if (value instanceof Map) {\n    return mapToJSON(value);\n  } else if (value && typeof value === 'object') {\n    return objectToJSON(value);\n  }\n  return value;\n}\nfunction createRoomConnectEventPayload(connectOptions) {\n  function boolToString(val) {\n    return val ? 'true' : 'false';\n  }\n  var payload = {\n    sessionSID: sessionSID,\n    // arrays props converted to lengths.\n    iceServers: (connectOptions.iceServers || []).length,\n    audioTracks: (connectOptions.tracks || []).filter(function (track) {\n      return track.kind === 'audio';\n    }).length,\n    videoTracks: (connectOptions.tracks || []).filter(function (track) {\n      return track.kind === 'video';\n    }).length,\n    dataTracks: (connectOptions.tracks || []).filter(function (track) {\n      return track.kind === 'data';\n    }).length\n  };\n  // boolean properties.\n  [['audio'], ['automaticSubscription'], ['enableDscp'], ['eventListener'], ['preflight'], ['video'], ['dominantSpeaker', 'enableDominantSpeaker']].forEach(function (_a) {\n    var _b = __read(_a, 2),\n      prop = _b[0],\n      eventProp = _b[1];\n    eventProp = eventProp || prop;\n    payload[eventProp] = boolToString(!!connectOptions[prop]);\n  });\n  // numbers properties.\n  [['maxVideoBitrate'], ['maxAudioBitrate']].forEach(function (_a) {\n    var _b = __read(_a, 2),\n      prop = _b[0],\n      eventProp = _b[1];\n    eventProp = eventProp || prop;\n    if (typeof connectOptions[prop] === 'number') {\n      payload[eventProp] = connectOptions[prop];\n    } else if (!isNaN(Number(connectOptions[prop]))) {\n      payload[eventProp] = Number(connectOptions[prop]);\n    }\n  });\n  // string properties.\n  [['iceTransportPolicy'], ['region'], ['name', 'roomName']].forEach(function (_a) {\n    var _b = __read(_a, 2),\n      prop = _b[0],\n      eventProp = _b[1];\n    eventProp = eventProp || prop;\n    if (typeof connectOptions[prop] === 'string') {\n      payload[eventProp] = connectOptions[prop];\n    } else if (typeof connectOptions[prop] === 'number' && prop === 'name') {\n      payload[eventProp] = connectOptions[prop].toString();\n    }\n  });\n  // array props stringified.\n  ['preferredAudioCodecs', 'preferredVideoCodecs'].forEach(function (prop) {\n    if (prop in connectOptions) {\n      payload[prop] = JSON.stringify(connectOptions[prop]);\n    }\n  });\n  if ('networkQuality' in connectOptions) {\n    payload.networkQualityConfiguration = {};\n    if (isNonArrayObject(connectOptions.networkQuality)) {\n      ['local', 'remote'].forEach(function (prop) {\n        if (typeof connectOptions.networkQuality[prop] === 'number') {\n          payload.networkQualityConfiguration[prop] = connectOptions.networkQuality[prop];\n        }\n      });\n    } else {\n      payload.networkQualityConfiguration.remote = 0;\n      payload.networkQualityConfiguration.local = connectOptions.networkQuality ? 1 : 0;\n    }\n  }\n  if (connectOptions.bandwidthProfile && connectOptions.bandwidthProfile.video) {\n    var videoBPOptions_1 = connectOptions.bandwidthProfile.video || {};\n    payload.bandwidthProfileOptions = {};\n    ['mode', 'maxTracks', 'trackSwitchOffMode', 'dominantSpeakerPriority', 'maxSubscriptionBitrate', 'renderDimensions', 'contentPreferencesMode', 'clientTrackSwitchOffControl'].forEach(function (prop) {\n      if (typeof videoBPOptions_1[prop] === 'number' || typeof videoBPOptions_1[prop] === 'string') {\n        payload.bandwidthProfileOptions[prop] = videoBPOptions_1[prop];\n      } else if (typeof videoBPOptions_1[prop] === 'boolean') {\n        payload.bandwidthProfileOptions[prop] = boolToString(videoBPOptions_1[prop]);\n      } else if (typeof videoBPOptions_1[prop] === 'object') {\n        payload.bandwidthProfileOptions[prop] = JSON.stringify(videoBPOptions_1[prop]);\n      }\n    });\n  }\n  return {\n    group: 'room',\n    name: 'connect',\n    level: 'info',\n    payload: payload\n  };\n}\n/**\n * Create the bandwidth profile payload included in an RSP connect message.\n * @param {BandwidthProfileOptions} bandwidthProfile\n * @returns {object}\n */\nfunction createBandwidthProfilePayload(bandwidthProfile) {\n  return createRSPPayload(bandwidthProfile, [{\n    prop: 'video',\n    type: 'object',\n    transform: createBandwidthProfileVideoPayload\n  }]);\n}\n/**\n * Create the bandwidth profile video payload included in an RSP connect message.\n * @param {VideoBandwidthProfileOptions} bandwidthProfileVideo\n * @returns {object}\n */\nfunction createBandwidthProfileVideoPayload(bandwidthProfileVideo) {\n  return createRSPPayload(bandwidthProfileVideo, [{\n    prop: 'dominantSpeakerPriority',\n    type: 'string',\n    payloadProp: 'active_speaker_priority'\n  }, {\n    prop: 'maxSubscriptionBitrate',\n    type: 'number',\n    payloadProp: 'max_subscription_bandwidth'\n  }, {\n    prop: 'maxTracks',\n    type: 'number',\n    payloadProp: 'max_tracks'\n  }, {\n    prop: 'mode',\n    type: 'string'\n  }, {\n    prop: 'renderDimensions',\n    type: 'object',\n    payloadProp: 'render_dimensions',\n    transform: createRenderDimensionsPayload\n  }, {\n    prop: 'trackSwitchOffMode',\n    type: 'string',\n    payloadProp: 'track_switch_off'\n  }]);\n}\n/**\n * Create the Media Signaling payload included in an RSP connect message.\n * @param {boolean} dominantSpeaker - whether to enable the Dominant Speaker\n *   protocol or not\n * @param {boolean} networkQuality - whether to enable the Network Quality\n *   protocol or not\n * @param {boolean} trackPriority - whether to enable the Track Priority\n *   protocol or not\n * @param {boolean} trackSwitchOff - whether to enable the Track Switch-Off\n *   protocol or not.\n * @param {boolean} renderHints - whether to enable the renderHints\n *   protocol or not.\n * @returns {object}\n */\nfunction createMediaSignalingPayload(dominantSpeaker, networkQuality, trackPriority, trackSwitchOff, adaptiveSimulcast, renderHints) {\n  var transports = {\n    transports: [{\n      type: 'data-channel'\n    }]\n  };\n  return Object.assign(dominantSpeaker\n  // eslint-disable-next-line\n  ? {\n    active_speaker: transports\n  } : {}, networkQuality\n  // eslint-disable-next-line\n  ? {\n    network_quality: transports\n  } : {}, renderHints\n  // eslint-disable-next-line\n  ? {\n    render_hints: transports\n  } : {}, adaptiveSimulcast\n  // eslint-disable-next-line\n  ? {\n    publisher_hints: transports\n  } : {}, trackPriority\n  // eslint-disable-next-line\n  ? {\n    track_priority: transports\n  } : {}, trackSwitchOff\n  // eslint-disable-next-line\n  ? {\n    track_switch_off: transports\n  } : {});\n}\n/**\n * Create {@link VideoTrack.Dimensions} RSP payload.\n * @param {VideoTrack.Dimensions} [dimensions]\n * @returns {object}\n */\nfunction createDimensionsPayload(dimensions) {\n  return createRSPPayload(dimensions, [{\n    prop: 'height',\n    type: 'number'\n  }, {\n    prop: 'width',\n    type: 'number'\n  }]);\n}\n/**\n * Create {@link VideoRenderDimensions} RSP payload.\n * @param renderDimensions\n * @returns {object}\n */\nfunction createRenderDimensionsPayload(renderDimensions) {\n  var PRIORITY_HIGH = trackPriority.PRIORITY_HIGH,\n    PRIORITY_LOW = trackPriority.PRIORITY_LOW,\n    PRIORITY_STANDARD = trackPriority.PRIORITY_STANDARD;\n  return createRSPPayload(renderDimensions, [{\n    prop: PRIORITY_HIGH,\n    type: 'object',\n    transform: createDimensionsPayload\n  }, {\n    prop: PRIORITY_LOW,\n    type: 'object',\n    transform: createDimensionsPayload\n  }, {\n    prop: PRIORITY_STANDARD,\n    type: 'object',\n    transform: createDimensionsPayload\n  }]);\n}\n/**\n * Create an RSP payload for the given object.\n * @param {object} object - object for which RSP payload is to be generated\n * @param {Array<object>} propConversions - conversion rules for object properties;\n *   they specify how object properties should be converted to their corresponding\n *   RSP payload properties\n * @returns {object}\n */\nfunction createRSPPayload(object, propConversions) {\n  return propConversions.reduce(function (payload, _a) {\n    var _b;\n    var prop = _a.prop,\n      type = _a.type,\n      _c = _a.payloadProp,\n      payloadProp = _c === void 0 ? prop : _c,\n      _d = _a.transform,\n      transform = _d === void 0 ? function (x) {\n        return x;\n      } : _d;\n    return typeof object[prop] === type ? Object.assign((_b = {}, _b[payloadProp] = transform(object[prop]), _b), payload) : payload;\n  }, {});\n}\n/**\n * Create the subscribe payload included in an RSP connect/update message.\n * @param {boolean} automaticSubscription - whether to subscribe to all RemoteTracks\n * @returns {object}\n */\nfunction createSubscribePayload(automaticSubscription) {\n  return {\n    rules: [{\n      type: automaticSubscription ? 'include' : 'exclude',\n      all: true\n    }],\n    revision: 1\n  };\n}\nfunction createMediaWarningsPayload(notifyWarnings) {\n  var _a;\n  var mediaWarnings = (_a = {}, _a[TwilioWarning.recordingMediaLost] = 'recordings', _a);\n  return notifyWarnings.map(function (twilioWarningName) {\n    return mediaWarnings[twilioWarningName];\n  }).filter(function (name) {\n    return !!name;\n  });\n}\n/**\n * Add random jitter to a given value in the range [-jitter, jitter].\n * @private\n * @param {number} value\n * @param {number} jitter\n * @returns {number} value + random(-jitter, +jitter)\n */\nfunction withJitter(value, jitter) {\n  var rand = Math.random();\n  return value - jitter + Math.floor(2 * jitter * rand + 0.5);\n}\n/**\n * Checks if the a number is in the range [min, max].\n * @private\n * @param {num} num\n * @param {number} min\n * @param {number} max\n * @return {boolean}\n */\nfunction inRange(num, min, max) {\n  return min <= num && num <= max;\n}\n/**\n * returns true if given MediaStreamTrack is a screen share track\n * @private\n * @param {MediaStreamTrack} track\n * @returns {boolean}\n */\nfunction isChromeScreenShareTrack(track) {\n  // NOTE(mpatwardhan): Chrome creates screen share tracks with label like: \"screen:69734272*\"\n  // we will check for label that starts with \"screen:D\" where D being a digit.\n  return util.guessBrowser() === 'chrome' && track.kind === 'video' && 'displaySurface' in track.getSettings();\n}\n/**\n * Returns a promise that resolve after timeoutMS have passed.\n * @param {number} timeoutMS - time to wait in milliseconds.\n * @returns {Promise<void>}\n */\nfunction waitForSometime(timeoutMS) {\n  if (timeoutMS === void 0) {\n    timeoutMS = 10;\n  }\n  return new Promise(function (resolve) {\n    return setTimeout(resolve, timeoutMS);\n  });\n}\n/**\n * Returns a promise that resolve after event is received\n * @returns {Promise<void>}\n */\nfunction waitForEvent(eventTarget, event) {\n  return new Promise(function (resolve) {\n    eventTarget.addEventListener(event, function onevent(e) {\n      eventTarget.removeEventListener(event, onevent);\n      resolve(e);\n    });\n  });\n}\nexports.constants = constants;\nexports.createBandwidthProfilePayload = createBandwidthProfilePayload;\nexports.createMediaSignalingPayload = createMediaSignalingPayload;\nexports.createMediaWarningsPayload = createMediaWarningsPayload;\nexports.createRoomConnectEventPayload = createRoomConnectEventPayload;\nexports.createSubscribePayload = createSubscribePayload;\nexports.asLocalTrack = asLocalTrack;\nexports.asLocalTrackPublication = asLocalTrackPublication;\nexports.capitalize = capitalize;\nexports.deprecateEvents = deprecateEvents;\nexports.difference = difference;\nexports.filterObject = filterObject;\nexports.flatMap = flatMap;\nexports.getPlatform = getPlatform;\nexports.getUserAgent = getUserAgent;\nexports.hidePrivateProperties = hidePrivateProperties;\nexports.hidePrivateAndCertainPublicPropertiesInClass = hidePrivateAndCertainPublicPropertiesInClass;\nexports.isDeepEqual = isDeepEqual;\nexports.isNonArrayObject = isNonArrayObject;\nexports.inRange = inRange;\nexports.makeUUID = makeUUID;\nexports.oncePerTick = oncePerTick;\nexports.promiseFromEvents = promiseFromEvents;\nexports.getOrNull = getOrNull;\nexports.defer = defer;\nexports.delegateMethods = delegateMethods;\nexports.proxyProperties = proxyProperties;\nexports.legacyPromise = legacyPromise;\nexports.buildLogLevels = buildLogLevels;\nexports.trackClass = trackClass;\nexports.trackPublicationClass = trackPublicationClass;\nexports.valueToJSON = valueToJSON;\nexports.withJitter = withJitter;\nexports.isChromeScreenShareTrack = isChromeScreenShareTrack;\nexports.waitForSometime = waitForSometime;\nexports.waitForEvent = waitForEvent;","map":{"version":3,"names":["constants","require","E","typeErrors","trackPriority","util","sessionSID","TwilioWarning","asLocalTrack","track","options","LocalAudioTrack","LocalVideoTrack","LocalDataTrack","MediaStreamTrack","kind","INVALID_TYPE","asLocalTrackPublication","signaling","unpublish","LocalTrackPublication","audio","LocalAudioTrackPublication","video","LocalVideoTrackPublication","data","LocalDataTrackPublication","capitalize","word","toUpperCase","slice","deprecateEvents","name","emitter","events","log","warningsShown","Set","on","newListener","event","has","deprecated","get","add","size","removeListener","difference","list1","list2","Array","isArray","values","forEach","item","filterObject","object","filterValue","Object","keys","reduce","filtered","key","flatMap","list","mapFn","listArray","Map","from","flattened","mapped","concat","getUserAgent","navigator","userAgent","getPlatform","_a","__read","match","_b","_c","split","map","entry","trim","platform","toLowerCase","makeUUID","replace","c","r","Math","random","v","toString","oncePerTick","fn","timeout","nextTick","scheduleNextTick","clearTimeout","setTimeout","promiseFromEvents","operation","eventEmitter","successEvent","failureEvent","Promise","resolve","reject","onSuccess","args","call","arguments","onFailure","apply","__spreadArray","once","getOrNull","obj","path","output","step","defer","deferred","promise","delegateMethod","source","wrapper","target","methodName","type","error","_i","length","delegateMethods","isDeepEqual","val1","val2","every","val","i","val1Keys","sort","val2Keys","isNonArrayObject","proxyProperties","getOwnPropertyNames","propertyName","proxyProperty","defineProperty","value","writable","addEventListener","dispatchEvent","enumerable","legacyPromise","then","result","buildLogLevels","logLevel","default","media","webrtc","trackClass","local","m","trackPublicationClass","publication","hidePrivateProperties","startsWith","hideProperty","hidePrivateAndCertainPublicPropertiesInClass","klass","props","_super","__extends","class_1","_this","hidePublicProperties","descriptor","getOwnPropertyDescriptor","hasOwnProperty","arrayToJSON","array","valueToJSON","setToJSON","set","mapToJSON","entries","json","assign","objectToJSON","createRoomConnectEventPayload","connectOptions","boolToString","payload","iceServers","audioTracks","tracks","filter","videoTracks","dataTracks","prop","eventProp","isNaN","Number","JSON","stringify","networkQualityConfiguration","networkQuality","remote","bandwidthProfile","videoBPOptions_1","bandwidthProfileOptions","group","level","createBandwidthProfilePayload","createRSPPayload","transform","createBandwidthProfileVideoPayload","bandwidthProfileVideo","payloadProp","createRenderDimensionsPayload","createMediaSignalingPayload","dominantSpeaker","trackSwitchOff","adaptiveSimulcast","renderHints","transports","active_speaker","network_quality","render_hints","publisher_hints","track_priority","track_switch_off","createDimensionsPayload","dimensions","renderDimensions","PRIORITY_HIGH","PRIORITY_LOW","PRIORITY_STANDARD","propConversions","_d","x","createSubscribePayload","automaticSubscription","rules","all","revision","createMediaWarningsPayload","notifyWarnings","mediaWarnings","recordingMediaLost","twilioWarningName","withJitter","jitter","rand","floor","inRange","num","min","max","isChromeScreenShareTrack","guessBrowser","getSettings","waitForSometime","timeoutMS","waitForEvent","eventTarget","onevent","e","removeEventListener","exports"],"sources":["/home/denis/RiderProjects/ChatRoulette/WebUI/chat-app/node_modules/twilio-video/lib/util/index.js"],"sourcesContent":["'use strict';\n\nconst constants = require('./constants');\nconst { typeErrors: E, trackPriority } = constants;\nconst util = require('../webrtc/util');\nconst { sessionSID } = require('./sid');\nconst TwilioWarning = require('./twiliowarning');\n\n/**\n * Return the given {@link LocalTrack} or a new {@link LocalTrack} for the\n * given MediaStreamTrack.\n * @param {LocalTrack|MediaStreamTrack} track\n * @param {object} options\n * @returns {LocalTrack}\n * @throws {TypeError}\n */\nfunction asLocalTrack(track, options) {\n  if (track instanceof options.LocalAudioTrack\n    || track instanceof options.LocalVideoTrack\n    || track instanceof options.LocalDataTrack) {\n    return track;\n  }\n  if (track instanceof options.MediaStreamTrack) {\n    return track.kind === 'audio'\n      ? new options.LocalAudioTrack(track, options)\n      : new options.LocalVideoTrack(track, options);\n  }\n  /* eslint new-cap:0 */\n  throw E.INVALID_TYPE('track', 'LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack');\n}\n\n/**\n * Create a new {@link LocalTrackPublication} for the given {@link LocalTrack}.\n * @param {LocalTrack} track\n * @param {LocalTrackPublicationSignaling} signaling\n * @param {function(track: LocalTrackPublication): void} unpublish\n * @param {object} options\n */\nfunction asLocalTrackPublication(track, signaling, unpublish, options) {\n  const LocalTrackPublication = {\n    audio: options.LocalAudioTrackPublication,\n    video: options.LocalVideoTrackPublication,\n    data: options.LocalDataTrackPublication\n  }[track.kind];\n  return new LocalTrackPublication(signaling, track, unpublish, options);\n}\n\n/**\n * Capitalize a word.\n * @param {string} word\n * @returns {string} capitalized\n */\nfunction capitalize(word) {\n  return word[0].toUpperCase() + word.slice(1);\n}\n\n/**\n * Log deprecation warnings for the given events of an EventEmitter.\n * @param {string} name\n * @param {EventEmitter} emitter\n * @param {Map<string, string>} events\n * @param {Log} log\n */\nfunction deprecateEvents(name, emitter, events, log) {\n  const warningsShown = new Set();\n  emitter.on('newListener', function newListener(event) {\n    if (events.has(event) && !warningsShown.has(event)) {\n      log.deprecated(`${name}#${event} has been deprecated and scheduled for removal in twilio-video.js@2.0.0.${events.get(event)\n        ? ` Use ${name}#${events.get(event)} instead.`\n        : ''}`);\n      warningsShown.add(event);\n    }\n    if (warningsShown.size >= events.size) {\n      emitter.removeListener('newListener', newListener);\n    }\n  });\n}\n\n/**\n * Finds the items in list1 that are not in list2.\n * @param {Array<*>|Map<*>|Set<*>} list1\n * @param {Array<*>|Map<*>|Set<*>} list2\n * @returns {Set}\n */\nfunction difference(list1, list2) {\n  list1 = Array.isArray(list1) ? new Set(list1) : new Set(list1.values());\n  list2 = Array.isArray(list2) ? new Set(list2) : new Set(list2.values());\n\n  const difference = new Set();\n\n  list1.forEach(item => {\n    if (!list2.has(item)) {\n      difference.add(item);\n    }\n  });\n\n  return difference;\n}\n\n/**\n * Filter out the keys in an object with a given value.\n * @param {object} object - Object to be filtered\n * @param {*} [filterValue] - Value to be filtered out; If not specified, then\n *   filters out all keys which have an explicit value of \"undefined\"\n * @returns {object} - Filtered object\n */\nfunction filterObject(object, filterValue) {\n  return Object.keys(object).reduce((filtered, key) => {\n    if (object[key] !== filterValue) {\n      filtered[key] = object[key];\n    }\n    return filtered;\n  }, {});\n}\n\n/**\n * Map a list to an array of arrays, and return the flattened result.\n * @param {Array<*>|Set<*>|Map<*>} list\n * @param {function(*): Array<*>} [mapFn]\n * @returns Array<*>\n */\nfunction flatMap(list, mapFn) {\n  const listArray = list instanceof Map || list instanceof Set\n    ? Array.from(list.values())\n    : list;\n\n  mapFn = mapFn || function mapFn(item) {\n    return item;\n  };\n\n  return listArray.reduce((flattened, item) => {\n    const mapped = mapFn(item);\n    return flattened.concat(mapped);\n  }, []);\n}\n\n/**\n * Get the user agent string, or return \"Unknown\".\n * @returns {string}\n */\nfunction getUserAgent() {\n  return typeof navigator !== 'undefined' && navigator.userAgent\n    ? navigator.userAgent\n    : 'Unknown';\n}\n\n/**\n * Get the platform component of the user agent string.\n * Example:\n *   Input - Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36\n *   Output - macintosh\n * @returns {string}\n */\nfunction getPlatform() {\n  const userAgent = getUserAgent();\n  const [, match = 'unknown'] = userAgent.match(/\\(([^)]+)\\)/) || [];\n  const [platform] = match.split(';').map(entry => entry.trim());\n  return platform.toLowerCase();\n}\n\n/**\n * Create a unique identifier.\n * @returns {string}\n */\nfunction makeUUID() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {\n    const r = Math.random() * 16 | 0;\n    const v = c === 'x' ? r : (r & 0x3 | 0x8);\n    return v.toString(16);\n  });\n}\n\n/**\n * Ensure that the given function is called once per tick.\n * @param {function} fn - Function to be executed\n * @returns {function} - Schedules the given function to be called on the next tick\n */\nfunction oncePerTick(fn) {\n  let timeout = null;\n\n  function nextTick() {\n    timeout = null;\n    fn();\n  }\n\n  return function scheduleNextTick() {\n    if (timeout) {\n      clearTimeout(timeout);\n    }\n    timeout = setTimeout(nextTick);\n  };\n}\n\nfunction promiseFromEvents(operation, eventEmitter, successEvent, failureEvent) {\n  return new Promise((resolve, reject) => {\n    function onSuccess() {\n      const args = [].slice.call(arguments);\n      if (failureEvent) {\n        eventEmitter.removeListener(failureEvent, onFailure);\n      }\n      resolve(...args);\n    }\n    function onFailure() {\n      const args = [].slice.call(arguments);\n      eventEmitter.removeListener(successEvent, onSuccess);\n      reject(...args);\n    }\n    eventEmitter.once(successEvent, onSuccess);\n    if (failureEvent) {\n      eventEmitter.once(failureEvent, onFailure);\n    }\n    operation();\n  });\n}\n\n/**\n * Traverse down multiple nodes on an object and return null if\n * any link in the path is unavailable.\n * @param {Object} obj - Object to traverse\n * @param {String} path - Path to traverse. Period-separated.\n * @returns {Any|null}\n */\nfunction getOrNull(obj, path) {\n  return path.split('.').reduce((output, step) => {\n    if (!output) { return null; }\n    return output[step];\n  }, obj);\n}\n\n/**\n * @typedef {object} Deferred\n * @property {Promise} promise\n * @property {function} reject\n * @property {function} resolve\n */\n\n/**\n * Create a {@link Deferred}.\n * @returns {Deferred}\n */\nfunction defer() {\n  const deferred = {};\n  deferred.promise = new Promise((resolve, reject) => {\n    deferred.resolve = resolve;\n    deferred.reject = reject;\n  });\n  return deferred;\n}\n\n/**\n * Copy a method from a `source` prototype onto a `wrapper` prototype. Invoking\n * the method on the `wrapper` prototype will invoke the corresponding method\n * on an instance accessed by `target`.\n * @param {object} source\n * @param {object} wrapper\n * @param {string} target\n * @param {string} methodName\n * @returns {undefined}\n */\nfunction delegateMethod(source, wrapper, target, methodName) {\n  if (methodName in wrapper) {\n    // Skip any methods already set.\n    return;\n  } else if (methodName.match(/^on[a-z]+$/)) {\n    // Skip EventHandlers (these are handled in the constructor).\n    return;\n  }\n\n  let type;\n  try {\n    type = typeof source[methodName];\n  } catch (error) {\n    // NOTE(mroberts): Attempting to check the type of non-function members\n    // on the prototype throws an error for some types.\n  }\n\n  if (type !== 'function') {\n    // Skip non-function members.\n    return;\n  }\n\n  /* eslint no-loop-func:0 */\n  wrapper[methodName] = function(...args) {\n    return this[target][methodName](...args);\n  };\n}\n\n/**\n * Copy methods from a `source` prototype onto a `wrapper` prototype. Invoking\n * the methods on the `wrapper` prototype will invoke the corresponding method\n * on an instance accessed by `target`.\n * @param {object} source\n * @param {object} wrapper\n * @param {string} target\n * @returns {undefined}\n */\nfunction delegateMethods(source, wrapper, target) {\n  for (const methodName in source) {\n    delegateMethod(source, wrapper, target, methodName);\n  }\n}\n\n/**\n * Determine whether two values are deeply equal.\n * @param {*} val1\n * @param {*} val2\n * @returns {boolean}\n */\nfunction isDeepEqual(val1, val2) {\n  if (val1 === val2) {\n    return true;\n  }\n  if (typeof val1 !== typeof val2) {\n    return false;\n  }\n  if (val1 === null) {\n    return val2 === null;\n  }\n  if (val2 === null) {\n    return false;\n  }\n  if (Array.isArray(val1)) {\n    return Array.isArray(val2)\n      && val1.length === val2.length\n      && val1.every((val, i) => isDeepEqual(val, val2[i]));\n  }\n  if (typeof val1 === 'object') {\n    const val1Keys = Object.keys(val1).sort();\n    const val2Keys = Object.keys(val2).sort();\n    return !Array.isArray(val2)\n      && isDeepEqual(val1Keys, val2Keys)\n      && val1Keys.every(key => isDeepEqual(val1[key], val2[key]));\n  }\n  return false;\n}\n\n/**\n * Whether the given argument is a non-array object.\n * @param {*} object\n * @return {boolean}\n */\nfunction isNonArrayObject(object) {\n  return typeof object === 'object' && !Array.isArray(object);\n}\n\n/**\n * For each property name on the `source` prototype, add getters and/or setters\n * to `wrapper` that proxy to `target`.\n * @param {object} source\n * @param {object} wrapper\n * @param {string} target\n * @returns {undefined}\n */\nfunction proxyProperties(source, wrapper, target) {\n  Object.getOwnPropertyNames(source).forEach(propertyName => {\n    proxyProperty(source, wrapper, target, propertyName);\n  });\n}\n\n/**\n * For the property name on the `source` prototype, add a getter and/or setter\n * to `wrapper` that proxies to `target`.\n * @param {object} source\n * @param {object} wrapper\n * @param {string} target\n * @param {string} propertyName\n * @returns {undefined}\n */\nfunction proxyProperty(source, wrapper, target, propertyName) {\n  if (propertyName in wrapper) {\n    // Skip any properties already set.\n    return;\n  } else if (propertyName.match(/^on[a-z]+$/)) {\n    Object.defineProperty(wrapper, propertyName, {\n      value: null,\n      writable: true\n    });\n\n    target.addEventListener(propertyName.slice(2), function(...args) {\n      wrapper.dispatchEvent(...args);\n    });\n\n    return;\n  }\n\n  Object.defineProperty(wrapper, propertyName, {\n    enumerable: true,\n    get() {\n      return target[propertyName];\n    }\n  });\n}\n\n/**\n * This is a function for turning a Promise into the kind referenced in the\n * Legacy Interface Extensions section of the WebRTC spec.\n * @param {Promise<*>} promise\n * @param {function<*>} onSuccess\n * @param {function<Error>} onFailure\n * @returns {Promise<undefined>}\n */\nfunction legacyPromise(promise, onSuccess, onFailure) {\n  if (onSuccess) {\n    return promise.then(result => {\n      onSuccess(result);\n    }, error => {\n      onFailure(error);\n    });\n  }\n  return promise;\n}\n\n/**\n * Build the {@link LogLevels} object.\n * @param {String|LogLevel} logLevel - Log level name or object\n * @returns {LogLevels}\n */\nfunction buildLogLevels(logLevel) {\n  if (typeof logLevel === 'string') {\n    return {\n      default: logLevel,\n      media: logLevel,\n      signaling: logLevel,\n      webrtc: logLevel\n    };\n  }\n  return logLevel;\n}\n\n/**\n * Get the {@link Track}'s derived class name\n * @param {Track} track\n * @param {?boolean} [local=undefined]\n * @returns {string}\n */\nfunction trackClass(track, local) {\n  local = local ? 'Local' : '';\n  return `${local + (track.kind || '').replace(/\\w{1}/, m => m.toUpperCase())}Track`;\n}\n\n/**\n * Get the {@link TrackPublication}'s derived class name\n * @param {TrackPublication} publication\n * @param {?boolean} [local=undefined]\n * @returns {string}\n */\nfunction trackPublicationClass(publication, local) {\n  local = local ? 'Local' : '';\n  return `${local + (publication.kind || '').replace(/\\w{1}/, m => m.toUpperCase())}TrackPublication`;\n}\n\n/**\n * Sets all underscore-prefixed properties on `object` non-enumerable.\n * @param {Object} object\n * @returns {void}\n */\nfunction hidePrivateProperties(object) {\n  Object.getOwnPropertyNames(object).forEach(name => {\n    if (name.startsWith('_')) {\n      hideProperty(object, name);\n    }\n  });\n}\n\n/**\n * Creates a new subclass which, in the constructor, sets all underscore-prefixed\n * properties and the given public properties non-enumerable. This is useful for\n * patching up classes like EventEmitter which may set properties like `_events`\n * and `domain`.\n * @param {Function} klass\n * @param {Array<string>} props\n * @returns {Function} subclass\n */\nfunction hidePrivateAndCertainPublicPropertiesInClass(klass, props) {\n  // NOTE(mroberts): We do this to avoid giving the class a name.\n  return class extends klass {\n    constructor(...args) {\n      super(...args);\n      hidePrivateProperties(this);\n      hidePublicProperties(this, props);\n    }\n  };\n}\n\n/**\n * Hide a property of an object.\n * @param {object} object\n * @param {string} name\n */\nfunction hideProperty(object, name) {\n  const descriptor = Object.getOwnPropertyDescriptor(object, name);\n  descriptor.enumerable = false;\n  Object.defineProperty(object, name, descriptor);\n}\n\n/**\n * Hide the given public properties of an object.\n * @param {object} object\n * @param {Array<string>} [props=[]]\n */\nfunction hidePublicProperties(object, props = []) {\n  props.forEach(name => {\n    // eslint-disable-next-line no-prototype-builtins\n    if (object.hasOwnProperty(name)) {\n      hideProperty(object, name);\n    }\n  });\n}\n\n/**\n * Convert an Array of values to an Array of JSON values by calling\n * `valueToJSON` on each value.\n * @param {Array<*>} array\n * @returns {Array<*>}\n */\nfunction arrayToJSON(array) {\n  return array.map(valueToJSON);\n}\n\n/**\n * Convert a Set of values to an Array of JSON values by calling `valueToJSON`\n * on each value.\n * @param {Set<*>} set\n * @returns {Array<*>}\n */\nfunction setToJSON(set) {\n  return arrayToJSON([...set]);\n}\n\n/**\n * Convert a Map from strings to values to an object of JSON values by calling\n * `valueToJSON` on each value.\n * @param {Map<string, *>} map\n * @returns {object}\n */\nfunction mapToJSON(map) {\n  return [...map.entries()].reduce((json, [key, value]) => {\n    return Object.assign({ [key]: valueToJSON(value) }, json);\n  }, {});\n}\n\n/**\n * Convert an object to a JSON value by calling `valueToJSON` on its enumerable\n * keys.\n * @param {object} object\n * @returns {object}\n */\nfunction objectToJSON(object) {\n  return Object.entries(object).reduce((json, [key, value]) => {\n    return Object.assign({ [key]: valueToJSON(value) }, json);\n  }, {});\n}\n\n/**\n * Convert a value into a JSON value.\n * @param {*} value\n * @returns {*}\n */\nfunction valueToJSON(value) {\n  if (Array.isArray(value)) {\n    return arrayToJSON(value);\n  } else if (value instanceof Set) {\n    return setToJSON(value);\n  } else if (value instanceof Map) {\n    return mapToJSON(value);\n  } else if (value && typeof value === 'object') {\n    return objectToJSON(value);\n  }\n  return value;\n}\n\nfunction createRoomConnectEventPayload(connectOptions) {\n  function boolToString(val) {\n    return val ? 'true' : 'false';\n  }\n  const payload = {\n    sessionSID,\n\n    // arrays props converted to lengths.\n    iceServers: (connectOptions.iceServers || []).length,\n    audioTracks: (connectOptions.tracks || []).filter(track => track.kind === 'audio').length,\n    videoTracks: (connectOptions.tracks || []).filter(track => track.kind === 'video').length,\n    dataTracks: (connectOptions.tracks || []).filter(track => track.kind === 'data').length,\n  };\n\n  // boolean properties.\n  [['audio'], ['automaticSubscription'], ['enableDscp'], ['eventListener'], ['preflight'], ['video'], ['dominantSpeaker', 'enableDominantSpeaker']].forEach(([prop, eventProp]) => {\n    eventProp = eventProp || prop;\n    payload[eventProp] = boolToString(!!connectOptions[prop]);\n  });\n\n  // numbers properties.\n  [['maxVideoBitrate'], ['maxAudioBitrate']].forEach(([prop, eventProp]) => {\n    eventProp = eventProp || prop;\n    if (typeof connectOptions[prop] === 'number') {\n      payload[eventProp] = connectOptions[prop];\n    } else if (!isNaN(Number(connectOptions[prop]))) {\n      payload[eventProp] = Number(connectOptions[prop]);\n    }\n  });\n\n  // string properties.\n  [['iceTransportPolicy'], ['region'], ['name', 'roomName']].forEach(([prop, eventProp]) => {\n    eventProp = eventProp || prop;\n    if (typeof connectOptions[prop] === 'string') {\n      payload[eventProp] = connectOptions[prop];\n    } else if (typeof connectOptions[prop] === 'number' && prop === 'name') {\n      payload[eventProp] = connectOptions[prop].toString();\n    }\n  });\n\n  // array props stringified.\n  ['preferredAudioCodecs', 'preferredVideoCodecs'].forEach(prop => {\n    if (prop in connectOptions) {\n      payload[prop] = JSON.stringify(connectOptions[prop]);\n    }\n  });\n\n  if ('networkQuality' in connectOptions) {\n    payload.networkQualityConfiguration = {};\n    if (isNonArrayObject(connectOptions.networkQuality)) {\n      ['local', 'remote'].forEach(prop => {\n        if (typeof connectOptions.networkQuality[prop] === 'number') {\n          payload.networkQualityConfiguration[prop] = connectOptions.networkQuality[prop];\n        }\n      });\n    } else {\n      payload.networkQualityConfiguration.remote = 0;\n      payload.networkQualityConfiguration.local = connectOptions.networkQuality ? 1 : 0;\n    }\n  }\n\n  if (connectOptions.bandwidthProfile && connectOptions.bandwidthProfile.video) {\n    const videoBPOptions = connectOptions.bandwidthProfile.video || {};\n    payload.bandwidthProfileOptions = {};\n    ['mode', 'maxTracks', 'trackSwitchOffMode', 'dominantSpeakerPriority', 'maxSubscriptionBitrate', 'renderDimensions', 'contentPreferencesMode', 'clientTrackSwitchOffControl'].forEach(prop => {\n      if (typeof videoBPOptions[prop] === 'number' || typeof videoBPOptions[prop] === 'string') {\n        payload.bandwidthProfileOptions[prop] = videoBPOptions[prop];\n      } else if (typeof videoBPOptions[prop] === 'boolean') {\n        payload.bandwidthProfileOptions[prop] = boolToString(videoBPOptions[prop]);\n      } else if (typeof videoBPOptions[prop] === 'object') {\n        payload.bandwidthProfileOptions[prop] = JSON.stringify(videoBPOptions[prop]);\n      }\n    });\n  }\n\n  return {\n    group: 'room',\n    name: 'connect',\n    level: 'info',\n    payload\n  };\n}\n\n/**\n * Create the bandwidth profile payload included in an RSP connect message.\n * @param {BandwidthProfileOptions} bandwidthProfile\n * @returns {object}\n */\nfunction createBandwidthProfilePayload(bandwidthProfile) {\n  return createRSPPayload(bandwidthProfile, [\n    { prop: 'video', type: 'object', transform: createBandwidthProfileVideoPayload }\n  ]);\n}\n\n/**\n * Create the bandwidth profile video payload included in an RSP connect message.\n * @param {VideoBandwidthProfileOptions} bandwidthProfileVideo\n * @returns {object}\n */\nfunction createBandwidthProfileVideoPayload(bandwidthProfileVideo) {\n  return createRSPPayload(bandwidthProfileVideo, [\n    { prop: 'dominantSpeakerPriority', type: 'string', payloadProp: 'active_speaker_priority' },\n    { prop: 'maxSubscriptionBitrate', type: 'number', payloadProp: 'max_subscription_bandwidth' },\n    { prop: 'maxTracks', type: 'number', payloadProp: 'max_tracks' },\n    { prop: 'mode', type: 'string' },\n    { prop: 'renderDimensions', type: 'object', payloadProp: 'render_dimensions', transform: createRenderDimensionsPayload },\n    { prop: 'trackSwitchOffMode', type: 'string', payloadProp: 'track_switch_off' }\n  ]);\n}\n\n/**\n * Create the Media Signaling payload included in an RSP connect message.\n * @param {boolean} dominantSpeaker - whether to enable the Dominant Speaker\n *   protocol or not\n * @param {boolean} networkQuality - whether to enable the Network Quality\n *   protocol or not\n * @param {boolean} trackPriority - whether to enable the Track Priority\n *   protocol or not\n * @param {boolean} trackSwitchOff - whether to enable the Track Switch-Off\n *   protocol or not.\n * @param {boolean} renderHints - whether to enable the renderHints\n *   protocol or not.\n * @returns {object}\n */\nfunction createMediaSignalingPayload(dominantSpeaker, networkQuality, trackPriority, trackSwitchOff, adaptiveSimulcast, renderHints) {\n  const transports = { transports: [{ type: 'data-channel' }] };\n  return Object.assign(\n    dominantSpeaker\n      // eslint-disable-next-line\n      ? { active_speaker: transports }\n      : {},\n    networkQuality\n      // eslint-disable-next-line\n      ? { network_quality: transports }\n      : {},\n    renderHints\n      // eslint-disable-next-line\n      ? { render_hints: transports }\n      : {},\n    adaptiveSimulcast\n      // eslint-disable-next-line\n      ? { publisher_hints: transports }\n      : {},\n    trackPriority\n      // eslint-disable-next-line\n      ? { track_priority: transports }\n      : {},\n    trackSwitchOff\n      // eslint-disable-next-line\n      ? { track_switch_off: transports }\n      : {}\n  );\n}\n\n/**\n * Create {@link VideoTrack.Dimensions} RSP payload.\n * @param {VideoTrack.Dimensions} [dimensions]\n * @returns {object}\n */\nfunction createDimensionsPayload(dimensions) {\n  return createRSPPayload(dimensions, [\n    { prop: 'height', type: 'number' },\n    { prop: 'width', type: 'number' }\n  ]);\n}\n\n/**\n * Create {@link VideoRenderDimensions} RSP payload.\n * @param renderDimensions\n * @returns {object}\n */\nfunction createRenderDimensionsPayload(renderDimensions) {\n  const { PRIORITY_HIGH, PRIORITY_LOW, PRIORITY_STANDARD } = trackPriority;\n  return createRSPPayload(renderDimensions, [\n    { prop: PRIORITY_HIGH, type: 'object', transform: createDimensionsPayload },\n    { prop: PRIORITY_LOW, type: 'object', transform: createDimensionsPayload },\n    { prop: PRIORITY_STANDARD, type: 'object', transform: createDimensionsPayload }\n  ]);\n}\n\n/**\n * Create an RSP payload for the given object.\n * @param {object} object - object for which RSP payload is to be generated\n * @param {Array<object>} propConversions - conversion rules for object properties;\n *   they specify how object properties should be converted to their corresponding\n *   RSP payload properties\n * @returns {object}\n */\nfunction createRSPPayload(object, propConversions) {\n  return propConversions.reduce((payload, { prop, type, payloadProp = prop, transform = x => x }) => {\n    return typeof object[prop] === type\n      ? Object.assign({ [payloadProp]: transform(object[prop]) }, payload)\n      : payload;\n  }, {});\n}\n\n/**\n * Create the subscribe payload included in an RSP connect/update message.\n * @param {boolean} automaticSubscription - whether to subscribe to all RemoteTracks\n * @returns {object}\n */\nfunction createSubscribePayload(automaticSubscription) {\n  return {\n    rules: [{\n      type: automaticSubscription ? 'include' : 'exclude',\n      all: true\n    }],\n    revision: 1\n  };\n}\n\nfunction createMediaWarningsPayload(notifyWarnings) {\n  const mediaWarnings = {\n    [TwilioWarning.recordingMediaLost]: 'recordings'\n  };\n  return notifyWarnings\n    .map(twilioWarningName => mediaWarnings[twilioWarningName])\n    .filter(name => !!name);\n}\n\n/**\n * Add random jitter to a given value in the range [-jitter, jitter].\n * @private\n * @param {number} value\n * @param {number} jitter\n * @returns {number} value + random(-jitter, +jitter)\n */\nfunction withJitter(value, jitter) {\n  const rand = Math.random();\n  return value - jitter + Math.floor(2 * jitter * rand + 0.5);\n}\n\n/**\n * Checks if the a number is in the range [min, max].\n * @private\n * @param {num} num\n * @param {number} min\n * @param {number} max\n * @return {boolean}\n */\nfunction inRange(num, min, max) {\n  return min <= num && num <= max;\n}\n\n/**\n * returns true if given MediaStreamTrack is a screen share track\n * @private\n * @param {MediaStreamTrack} track\n * @returns {boolean}\n */\nfunction isChromeScreenShareTrack(track) {\n  // NOTE(mpatwardhan): Chrome creates screen share tracks with label like: \"screen:69734272*\"\n  // we will check for label that starts with \"screen:D\" where D being a digit.\n  return util.guessBrowser() === 'chrome' && track.kind === 'video' && 'displaySurface' in track.getSettings();\n}\n\n/**\n * Returns a promise that resolve after timeoutMS have passed.\n * @param {number} timeoutMS - time to wait in milliseconds.\n * @returns {Promise<void>}\n */\nfunction waitForSometime(timeoutMS = 10) {\n  return new Promise(resolve => setTimeout(resolve, timeoutMS));\n}\n\n/**\n * Returns a promise that resolve after event is received\n * @returns {Promise<void>}\n */\nfunction waitForEvent(eventTarget, event) {\n  return new Promise(resolve => {\n    eventTarget.addEventListener(event, function onevent(e) {\n      eventTarget.removeEventListener(event, onevent);\n      resolve(e);\n    });\n  });\n}\n\nexports.constants = constants;\nexports.createBandwidthProfilePayload = createBandwidthProfilePayload;\nexports.createMediaSignalingPayload = createMediaSignalingPayload;\nexports.createMediaWarningsPayload = createMediaWarningsPayload;\nexports.createRoomConnectEventPayload = createRoomConnectEventPayload;\nexports.createSubscribePayload = createSubscribePayload;\nexports.asLocalTrack = asLocalTrack;\nexports.asLocalTrackPublication = asLocalTrackPublication;\nexports.capitalize = capitalize;\nexports.deprecateEvents = deprecateEvents;\nexports.difference = difference;\nexports.filterObject = filterObject;\nexports.flatMap = flatMap;\nexports.getPlatform = getPlatform;\nexports.getUserAgent = getUserAgent;\nexports.hidePrivateProperties = hidePrivateProperties;\nexports.hidePrivateAndCertainPublicPropertiesInClass = hidePrivateAndCertainPublicPropertiesInClass;\nexports.isDeepEqual = isDeepEqual;\nexports.isNonArrayObject = isNonArrayObject;\nexports.inRange = inRange;\nexports.makeUUID = makeUUID;\nexports.oncePerTick = oncePerTick;\nexports.promiseFromEvents = promiseFromEvents;\nexports.getOrNull = getOrNull;\nexports.defer = defer;\nexports.delegateMethods = delegateMethods;\nexports.proxyProperties = proxyProperties;\nexports.legacyPromise = legacyPromise;\nexports.buildLogLevels = buildLogLevels;\nexports.trackClass = trackClass;\nexports.trackPublicationClass = trackPublicationClass;\nexports.valueToJSON = valueToJSON;\nexports.withJitter = withJitter;\nexports.isChromeScreenShareTrack = isChromeScreenShareTrack;\nexports.waitForSometime = waitForSometime;\nexports.waitForEvent = waitForEvent;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}
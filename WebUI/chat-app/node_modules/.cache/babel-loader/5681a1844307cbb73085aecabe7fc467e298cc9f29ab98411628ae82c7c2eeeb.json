{"ast":null,"code":"'use strict';\n\nvar detectSilence = require('../webaudio/detectsilence');\nvar N_ATTEMPTS = 3;\nvar ATTEMPT_DURATION_MS = 250;\n/**\n * Detect whether the audio stream rendered by the given HTMLVideoElement is silent.\n * @param {HTMLAudioElement} el\n * @returns {Promise<boolean>} true if silent, false if not.\n */\nfunction detectSilentAudio(el) {\n  // NOTE(mmalavalli): We have to delay require-ing AudioContextFactory, because\n  // it exports a default instance whose constructor calls Object.assign.\n  var AudioContextFactory = require('../webaudio/audiocontext');\n  var holder = {};\n  var audioContext = AudioContextFactory.getOrCreate(holder);\n  var attemptsLeft = N_ATTEMPTS;\n  function doCheckSilence() {\n    attemptsLeft--;\n    return detectSilence(audioContext, el.srcObject, ATTEMPT_DURATION_MS).then(function (isSilent) {\n      if (!isSilent) {\n        return false;\n      }\n      if (attemptsLeft > 0) {\n        return doCheckSilence();\n      }\n      return true;\n    }).catch(function () {\n      // NOTE(mmalavalli): If an error is thrown while detect silence, the audio\n      // stream is assumed to be silent.\n      return true;\n    });\n  }\n  // Resolve the returned Promise with true if 3 consecutive attempts\n  // to detect silent audio are successful.\n  return doCheckSilence().finally(function () {\n    AudioContextFactory.release(holder);\n  });\n}\nmodule.exports = detectSilentAudio;","map":{"version":3,"names":["detectSilence","require","N_ATTEMPTS","ATTEMPT_DURATION_MS","detectSilentAudio","el","AudioContextFactory","holder","audioContext","getOrCreate","attemptsLeft","doCheckSilence","srcObject","then","isSilent","catch","finally","release","module","exports"],"sources":["/home/denis/RiderProjects/ChatRoulette/WebUI/chat-app/node_modules/twilio-video/lib/util/detectsilentaudio.js"],"sourcesContent":["'use strict';\n\nconst detectSilence = require('../webaudio/detectsilence');\n\nconst N_ATTEMPTS = 3;\nconst ATTEMPT_DURATION_MS = 250;\n\n/**\n * Detect whether the audio stream rendered by the given HTMLVideoElement is silent.\n * @param {HTMLAudioElement} el\n * @returns {Promise<boolean>} true if silent, false if not.\n */\nfunction detectSilentAudio(el) {\n  // NOTE(mmalavalli): We have to delay require-ing AudioContextFactory, because\n  // it exports a default instance whose constructor calls Object.assign.\n  const AudioContextFactory = require('../webaudio/audiocontext');\n  const holder = {};\n  const audioContext = AudioContextFactory.getOrCreate(holder);\n\n  let attemptsLeft = N_ATTEMPTS;\n\n  function doCheckSilence() {\n    attemptsLeft--;\n    return detectSilence(audioContext, el.srcObject, ATTEMPT_DURATION_MS).then(isSilent => {\n      if (!isSilent) {\n        return false;\n      }\n      if (attemptsLeft > 0) {\n        return doCheckSilence();\n      }\n      return true;\n    }).catch(() => {\n      // NOTE(mmalavalli): If an error is thrown while detect silence, the audio\n      // stream is assumed to be silent.\n      return true;\n    });\n  }\n\n  // Resolve the returned Promise with true if 3 consecutive attempts\n  // to detect silent audio are successful.\n  return doCheckSilence().finally(() => {\n    AudioContextFactory.release(holder);\n  });\n}\n\nmodule.exports = detectSilentAudio;\n"],"mappings":"AAAA,YAAY;;AAEZ,IAAMA,aAAa,GAAGC,OAAO,CAAC,2BAA2B,CAAC;AAE1D,IAAMC,UAAU,GAAG,CAAC;AACpB,IAAMC,mBAAmB,GAAG,GAAG;AAE/B;;;;;AAKA,SAASC,iBAAiBA,CAACC,EAAE;EAC3B;EACA;EACA,IAAMC,mBAAmB,GAAGL,OAAO,CAAC,0BAA0B,CAAC;EAC/D,IAAMM,MAAM,GAAG,EAAE;EACjB,IAAMC,YAAY,GAAGF,mBAAmB,CAACG,WAAW,CAACF,MAAM,CAAC;EAE5D,IAAIG,YAAY,GAAGR,UAAU;EAE7B,SAASS,cAAcA,CAAA;IACrBD,YAAY,EAAE;IACd,OAAOV,aAAa,CAACQ,YAAY,EAAEH,EAAE,CAACO,SAAS,EAAET,mBAAmB,CAAC,CAACU,IAAI,CAAC,UAAAC,QAAQ;MACjF,IAAI,CAACA,QAAQ,EAAE;QACb,OAAO,KAAK;;MAEd,IAAIJ,YAAY,GAAG,CAAC,EAAE;QACpB,OAAOC,cAAc,EAAE;;MAEzB,OAAO,IAAI;IACb,CAAC,CAAC,CAACI,KAAK,CAAC;MACP;MACA;MACA,OAAO,IAAI;IACb,CAAC,CAAC;EACJ;EAEA;EACA;EACA,OAAOJ,cAAc,EAAE,CAACK,OAAO,CAAC;IAC9BV,mBAAmB,CAACW,OAAO,CAACV,MAAM,CAAC;EACrC,CAAC,CAAC;AACJ;AAEAW,MAAM,CAACC,OAAO,GAAGf,iBAAiB"},"metadata":{},"sourceType":"script","externalDependencies":[]}
{"ast":null,"code":"/* eslint-disable camelcase */\n'use strict';\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n    return extendStatics(d, b);\n  };\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar EventEmitter = require('events').EventEmitter;\nvar getUserAgent = require('..').getUserAgent;\nvar MAX_RECONNECT_ATTEMPTS = 5;\nvar RECONNECT_INTERVAL_MS = 50;\nvar WS_CLOSE_NORMAL = 1000;\nvar toplevel = globalThis;\nvar WebSocket = toplevel.WebSocket ? toplevel.WebSocket : require('ws');\nvar _a = require('../constants'),\n  hardwareDevicePublisheriPad = _a.hardwareDevicePublisheriPad,\n  hardwareDevicePublisheriPhone = _a.hardwareDevicePublisheriPhone;\nvar util = require('../../util');\nvar browserdetection = require('../browserdetection');\n/**\n * Publish events to the Insights gateway.\n * @extends EventEmitter\n * @emits InsightsPublisher#connected\n * @emits InsightsPublisher#disconnected\n * @emits InsightsPublisher#reconnecting\n */\nvar InsightsPublisher = /** @class */function (_super) {\n  __extends(InsightsPublisher, _super);\n  /**\n   * @param {string} token - Insights gateway token\n   * @param {string} sdkName - Name of the SDK using the {@link InsightsPublisher}\n   * @param {string} sdkVersion - Version of the SDK using the {@link InsightsPublisher}\n   * @param {string} environment - One of 'dev', 'stage' or 'prod'\n   * @param {string} realm - Region identifier\n   * @param {InsightsPublisherOptions} options - Override default behavior\n   */\n  function InsightsPublisher(token, sdkName, sdkVersion, environment, realm, options) {\n    var _this = _super.call(this) || this;\n    options = Object.assign({\n      gateway: createGateway(environment, realm) + \"/v1/VideoEvents\",\n      maxReconnectAttempts: MAX_RECONNECT_ATTEMPTS,\n      reconnectIntervalMs: RECONNECT_INTERVAL_MS,\n      userAgent: getUserAgent(),\n      WebSocket: WebSocket\n    }, options);\n    Object.defineProperties(_this, {\n      _connectTimestamp: {\n        value: 0,\n        writable: true\n      },\n      _eventQueue: {\n        value: []\n      },\n      _readyToConnect: {\n        value: util.defer()\n      },\n      _reconnectAttemptsLeft: {\n        value: options.maxReconnectAttempts,\n        writable: true\n      },\n      _ws: {\n        value: null,\n        writable: true\n      },\n      _WebSocket: {\n        value: options.WebSocket\n      }\n    });\n    _this._readyToConnect.promise.then(function (_a) {\n      var roomSid = _a.roomSid,\n        participantSid = _a.participantSid;\n      var self = _this;\n      _this.on('disconnected', function maybeReconnect(error) {\n        self._session = null;\n        if (error && self._reconnectAttemptsLeft > 0) {\n          self.emit('reconnecting');\n          reconnect(self, token, sdkName, sdkVersion, roomSid, participantSid, options);\n          return;\n        }\n        self.removeListener('disconnected', maybeReconnect);\n      });\n      connect(_this, token, sdkName, sdkVersion, roomSid, participantSid, options);\n    }).catch(function () {\n      // ignore failures to connect\n    });\n    return _this;\n  }\n  /**\n   * Start connecting to the Insights gateway.\n   * @param {string} roomSid\n   * @param {string} participantSid\n   * @returns {void}\n   */\n  InsightsPublisher.prototype.connect = function (roomSid, participantSid) {\n    this._readyToConnect.resolve({\n      roomSid: roomSid,\n      participantSid: participantSid\n    });\n  };\n  /**\n   * Publish an event to the Insights gateway.\n   * @private\n   * @param {*} event\n   */\n  InsightsPublisher.prototype._publish = function (event) {\n    event.session = this._session;\n    this._ws.send(JSON.stringify(event));\n  };\n  /**\n   * Disconnect from the Insights gateway.\n   * @returns {boolean} true if called when connecting/open, false if not\n   */\n  InsightsPublisher.prototype.disconnect = function () {\n    if (this._ws === null || this._ws.readyState === this._WebSocket.CLOSING || this._ws.readyState === this._WebSocket.CLOSED) {\n      return false;\n    }\n    try {\n      this._ws.close();\n    } catch (error) {\n      // Do nothing.\n    }\n    this.emit('disconnected');\n    return true;\n  };\n  /**\n   * Publish (or queue, if not connected) an event to the Insights gateway.\n   * @param {string} groupName - Event group name\n   * @param {string} eventName - Event name\n   * @param {object} payload - Event payload\n   * @returns {boolean} true if queued or published, false if disconnect() called\n   */\n  InsightsPublisher.prototype.publish = function (groupName, eventName, payload) {\n    if (this._ws !== null && (this._ws.readyState === this._WebSocket.CLOSING || this._ws.readyState === this._WebSocket.CLOSED)) {\n      return false;\n    }\n    var publishOrEnqueue = typeof this._session === 'string' ? this._publish.bind(this) : this._eventQueue.push.bind(this._eventQueue);\n    publishOrEnqueue({\n      group: groupName,\n      name: eventName,\n      payload: payload,\n      timestamp: Date.now(),\n      type: 'event',\n      version: 1\n    });\n    return true;\n  };\n  return InsightsPublisher;\n}(EventEmitter);\n/**\n * Start connecting to the Insights gateway.\n * @private\n * @param {InsightsPublisher} publisher\n * @param {string} name\n * @param {string} token\n * @param {string} sdkName\n * @param {string} sdkVersion\n * @param {string} roomSid\n * @param {string} participantSid\n * @param {InsightsPublisherOptions} options\n */\nfunction connect(publisher, token, sdkName, sdkVersion, roomSid, participantSid, options) {\n  publisher._connectTimestamp = Date.now();\n  publisher._reconnectAttemptsLeft--;\n  publisher._ws = new options.WebSocket(options.gateway);\n  var ws = publisher._ws;\n  ws.addEventListener('close', function (event) {\n    if (event.code === WS_CLOSE_NORMAL) {\n      publisher.emit('disconnected');\n      return;\n    }\n    publisher.emit('disconnected', new Error(\"WebSocket Error \" + event.code + \": \" + event.reason));\n  });\n  ws.addEventListener('message', function (message) {\n    handleConnectResponse(publisher, JSON.parse(message.data), options);\n  });\n  ws.addEventListener('open', function () {\n    var connectRequest = {\n      type: 'connect',\n      token: token,\n      version: 1\n    };\n    connectRequest.publisher = {\n      name: sdkName,\n      sdkVersion: sdkVersion,\n      userAgent: options.userAgent,\n      participantSid: participantSid,\n      roomSid: roomSid\n    };\n    if (browserdetection.isIpad()) {\n      connectRequest.publisher = __assign(__assign({}, connectRequest.publisher), hardwareDevicePublisheriPad);\n    } else if (browserdetection.isIphone()) {\n      connectRequest.publisher = __assign(__assign({}, connectRequest.publisher), hardwareDevicePublisheriPhone);\n    }\n    ws.send(JSON.stringify(connectRequest));\n  });\n}\n/**\n * Create the Insights Websocket gateway URL.\n * @param {string} environment\n * @param {string} realm\n * @returns {string}\n */\nfunction createGateway(environment, realm) {\n  return environment === 'prod' ? \"wss://sdkgw.\" + realm + \".twilio.com\" : \"wss://sdkgw.\" + environment + \"-\" + realm + \".twilio.com\";\n}\n/**\n * Handle connect response from the Insights gateway.\n * @param {InsightsPublisher} publisher\n * @param {*} response\n * @param {InsightsPublisherOptions} options\n */\nfunction handleConnectResponse(publisher, response, options) {\n  switch (response.type) {\n    case 'connected':\n      publisher._session = response.session;\n      publisher._reconnectAttemptsLeft = options.maxReconnectAttempts;\n      publisher._eventQueue.splice(0).forEach(publisher._publish, publisher);\n      publisher.emit('connected');\n      break;\n    case 'error':\n      publisher._ws.close();\n      publisher.emit('disconnected', new Error(response.message));\n      break;\n  }\n}\n/**\n * Start re-connecting to the Insights gateway with an appropriate delay based\n * on InsightsPublisherOptions#reconnectIntervalMs.\n * @private\n * @param {InsightsPublisher} publisher\n * @param {string} token\n * @param {string} sdkName\n * @param {string} sdkVersion\n * @param {string} roomSid\n * @param {string} participantSid\n * @param {InsightsPublisherOptions} options\n */\nfunction reconnect(publisher, token, sdkName, sdkVersion, roomSid, participantSid, options) {\n  var connectInterval = Date.now() - publisher._connectTimestamp;\n  var timeToWait = options.reconnectIntervalMs - connectInterval;\n  if (timeToWait > 0) {\n    setTimeout(function () {\n      connect(publisher, token, sdkName, sdkVersion, roomSid, participantSid, options);\n    }, timeToWait);\n    return;\n  }\n  connect(publisher, token, sdkName, sdkVersion, roomSid, participantSid, options);\n}\n/**\n * The {@link InsightsPublisher} is connected to the gateway.\n * @event InsightsPublisher#connected\n */\n/**\n * The {@link InsightsPublisher} is disconnected from the gateway.\n * @event InsightsPublisher#disconnected\n * @param {Error} [error] - Optional error if disconnected unintentionally\n */\n/**\n * The {@link InsightsPublisher} is re-connecting to the gateway.\n * @event InsightsPublisher#reconnecting\n */\n/**\n * {@link InsightsPublisher} options.\n * @typedef {object} InsightsPublisherOptions\n * @property {string} [gateway=sdkgw.{environment}-{realm}.twilio.com] - Insights WebSocket gateway url\n * @property {number} [maxReconnectAttempts=5] - Max re-connect attempts\n * @property {number} [reconnectIntervalMs=50] - Re-connect interval in ms\n */\nmodule.exports = InsightsPublisher;","map":{"version":3,"names":["EventEmitter","require","getUserAgent","MAX_RECONNECT_ATTEMPTS","RECONNECT_INTERVAL_MS","WS_CLOSE_NORMAL","toplevel","globalThis","WebSocket","_a","hardwareDevicePublisheriPad","hardwareDevicePublisheriPhone","util","browserdetection","InsightsPublisher","_super","__extends","token","sdkName","sdkVersion","environment","realm","options","_this","call","Object","assign","gateway","createGateway","maxReconnectAttempts","reconnectIntervalMs","userAgent","defineProperties","_connectTimestamp","value","writable","_eventQueue","_readyToConnect","defer","_reconnectAttemptsLeft","_ws","_WebSocket","promise","then","roomSid","participantSid","self","on","maybeReconnect","error","_session","emit","reconnect","removeListener","connect","catch","prototype","resolve","_publish","event","session","send","JSON","stringify","disconnect","readyState","CLOSING","CLOSED","close","publish","groupName","eventName","payload","publishOrEnqueue","bind","push","group","name","timestamp","Date","now","type","version","publisher","ws","addEventListener","code","Error","reason","message","handleConnectResponse","parse","data","connectRequest","isIpad","__assign","isIphone","response","splice","forEach","connectInterval","timeToWait","setTimeout","module","exports"],"sources":["/home/denis/RiderProjects/ChatRoulette/WebUI/chat-app/node_modules/twilio-video/lib/util/insightspublisher/index.js"],"sourcesContent":["/* eslint-disable camelcase */\n'use strict';\n\nconst EventEmitter = require('events').EventEmitter;\n\nconst { getUserAgent } = require('..');\n\nconst MAX_RECONNECT_ATTEMPTS = 5;\nconst RECONNECT_INTERVAL_MS = 50;\nconst WS_CLOSE_NORMAL = 1000;\n\nconst toplevel = globalThis;\nconst WebSocket = toplevel.WebSocket ? toplevel.WebSocket : require('ws');\nconst { hardwareDevicePublisheriPad, hardwareDevicePublisheriPhone } = require('../constants');\nconst util = require('../../util');\nconst browserdetection = require('../browserdetection');\n\n/**\n * Publish events to the Insights gateway.\n * @extends EventEmitter\n * @emits InsightsPublisher#connected\n * @emits InsightsPublisher#disconnected\n * @emits InsightsPublisher#reconnecting\n */\nclass InsightsPublisher extends EventEmitter {\n  /**\n   * @param {string} token - Insights gateway token\n   * @param {string} sdkName - Name of the SDK using the {@link InsightsPublisher}\n   * @param {string} sdkVersion - Version of the SDK using the {@link InsightsPublisher}\n   * @param {string} environment - One of 'dev', 'stage' or 'prod'\n   * @param {string} realm - Region identifier\n   * @param {InsightsPublisherOptions} options - Override default behavior\n   */\n  constructor(token, sdkName, sdkVersion, environment, realm, options) {\n    super();\n\n    options = Object.assign({\n      gateway: `${createGateway(environment, realm)}/v1/VideoEvents`,\n      maxReconnectAttempts: MAX_RECONNECT_ATTEMPTS,\n      reconnectIntervalMs: RECONNECT_INTERVAL_MS,\n      userAgent: getUserAgent(),\n      WebSocket,\n    }, options);\n\n    Object.defineProperties(this, {\n      _connectTimestamp: {\n        value: 0,\n        writable: true\n      },\n      _eventQueue: {\n        value: []\n      },\n      _readyToConnect: {\n        value: util.defer()\n      },\n      _reconnectAttemptsLeft: {\n        value: options.maxReconnectAttempts,\n        writable: true\n      },\n      _ws: {\n        value: null,\n        writable: true\n      },\n      _WebSocket: {\n        value: options.WebSocket\n      }\n    });\n\n    this._readyToConnect.promise.then(({ roomSid, participantSid }) => {\n      const self = this;\n      this.on('disconnected', function maybeReconnect(error) {\n        self._session = null;\n        if (error && self._reconnectAttemptsLeft > 0) {\n          self.emit('reconnecting');\n          reconnect(self, token, sdkName, sdkVersion, roomSid, participantSid, options);\n          return;\n        }\n        self.removeListener('disconnected', maybeReconnect);\n      });\n      connect(this, token, sdkName, sdkVersion, roomSid, participantSid, options);\n    }).catch(() => {\n      // ignore failures to connect\n    });\n  }\n\n  /**\n   * Start connecting to the Insights gateway.\n   * @param {string} roomSid\n   * @param {string} participantSid\n   * @returns {void}\n   */\n  connect(roomSid, participantSid) {\n    this._readyToConnect.resolve({ roomSid, participantSid });\n  }\n\n  /**\n   * Publish an event to the Insights gateway.\n   * @private\n   * @param {*} event\n   */\n  _publish(event) {\n    event.session = this._session;\n    this._ws.send(JSON.stringify(event));\n  }\n\n  /**\n   * Disconnect from the Insights gateway.\n   * @returns {boolean} true if called when connecting/open, false if not\n   */\n  disconnect() {\n    if (this._ws === null\n      || this._ws.readyState === this._WebSocket.CLOSING\n      || this._ws.readyState === this._WebSocket.CLOSED) {\n      return false;\n    }\n\n    try {\n      this._ws.close();\n    } catch (error) {\n      // Do nothing.\n    }\n    this.emit('disconnected');\n\n    return true;\n  }\n\n  /**\n   * Publish (or queue, if not connected) an event to the Insights gateway.\n   * @param {string} groupName - Event group name\n   * @param {string} eventName - Event name\n   * @param {object} payload - Event payload\n   * @returns {boolean} true if queued or published, false if disconnect() called\n   */\n  publish(groupName, eventName, payload) {\n    if (this._ws !== null\n      && (this._ws.readyState === this._WebSocket.CLOSING\n        || this._ws.readyState === this._WebSocket.CLOSED)) {\n      return false;\n    }\n\n    const publishOrEnqueue = typeof this._session === 'string'\n      ? this._publish.bind(this)\n      : this._eventQueue.push.bind(this._eventQueue);\n\n    publishOrEnqueue({\n      group: groupName,\n      name: eventName,\n      payload,\n      timestamp: Date.now(),\n      type: 'event',\n      version: 1\n    });\n\n    return true;\n  }\n}\n\n/**\n * Start connecting to the Insights gateway.\n * @private\n * @param {InsightsPublisher} publisher\n * @param {string} name\n * @param {string} token\n * @param {string} sdkName\n * @param {string} sdkVersion\n * @param {string} roomSid\n * @param {string} participantSid\n * @param {InsightsPublisherOptions} options\n */\nfunction connect(publisher, token, sdkName, sdkVersion, roomSid, participantSid, options) {\n  publisher._connectTimestamp = Date.now();\n  publisher._reconnectAttemptsLeft--;\n  publisher._ws = new options.WebSocket(options.gateway);\n  const ws = publisher._ws;\n\n  ws.addEventListener('close', event => {\n    if (event.code === WS_CLOSE_NORMAL) {\n      publisher.emit('disconnected');\n      return;\n    }\n    publisher.emit('disconnected', new Error(`WebSocket Error ${event.code}: ${event.reason}`));\n  });\n\n  ws.addEventListener('message', message => {\n    handleConnectResponse(publisher, JSON.parse(message.data), options);\n  });\n\n  ws.addEventListener('open', () => {\n    const connectRequest = {\n      type: 'connect',\n      token,\n      version: 1\n    };\n\n    connectRequest.publisher = {\n      name: sdkName,\n      sdkVersion,\n      userAgent: options.userAgent,\n      participantSid: participantSid,\n      roomSid: roomSid,\n    };\n\n    if (browserdetection.isIpad()) {\n      connectRequest.publisher = { ...connectRequest.publisher, ...hardwareDevicePublisheriPad };\n    } else if (browserdetection.isIphone()) {\n      connectRequest.publisher = { ...connectRequest.publisher, ...hardwareDevicePublisheriPhone };\n    }\n\n    ws.send(JSON.stringify(connectRequest));\n  });\n}\n\n/**\n * Create the Insights Websocket gateway URL.\n * @param {string} environment\n * @param {string} realm\n * @returns {string}\n */\nfunction createGateway(environment, realm) {\n  return environment === 'prod' ? `wss://sdkgw.${realm}.twilio.com`\n    : `wss://sdkgw.${environment}-${realm}.twilio.com`;\n}\n\n/**\n * Handle connect response from the Insights gateway.\n * @param {InsightsPublisher} publisher\n * @param {*} response\n * @param {InsightsPublisherOptions} options\n */\nfunction handleConnectResponse(publisher, response, options) {\n  switch (response.type) {\n    case 'connected':\n      publisher._session = response.session;\n      publisher._reconnectAttemptsLeft = options.maxReconnectAttempts;\n      publisher._eventQueue.splice(0).forEach(publisher._publish, publisher);\n      publisher.emit('connected');\n      break;\n    case 'error':\n      publisher._ws.close();\n      publisher.emit('disconnected', new Error(response.message));\n      break;\n  }\n}\n\n/**\n * Start re-connecting to the Insights gateway with an appropriate delay based\n * on InsightsPublisherOptions#reconnectIntervalMs.\n * @private\n * @param {InsightsPublisher} publisher\n * @param {string} token\n * @param {string} sdkName\n * @param {string} sdkVersion\n * @param {string} roomSid\n * @param {string} participantSid\n * @param {InsightsPublisherOptions} options\n */\nfunction reconnect(publisher, token, sdkName, sdkVersion, roomSid, participantSid, options) {\n  const connectInterval = Date.now() - publisher._connectTimestamp;\n  const timeToWait = options.reconnectIntervalMs - connectInterval;\n\n  if (timeToWait > 0) {\n    setTimeout(() => {\n      connect(publisher, token, sdkName, sdkVersion, roomSid, participantSid, options);\n    }, timeToWait);\n    return;\n  }\n\n  connect(publisher, token, sdkName, sdkVersion, roomSid, participantSid, options);\n}\n\n/**\n * The {@link InsightsPublisher} is connected to the gateway.\n * @event InsightsPublisher#connected\n */\n\n/**\n * The {@link InsightsPublisher} is disconnected from the gateway.\n * @event InsightsPublisher#disconnected\n * @param {Error} [error] - Optional error if disconnected unintentionally\n */\n\n/**\n * The {@link InsightsPublisher} is re-connecting to the gateway.\n * @event InsightsPublisher#reconnecting\n */\n\n/**\n * {@link InsightsPublisher} options.\n * @typedef {object} InsightsPublisherOptions\n * @property {string} [gateway=sdkgw.{environment}-{realm}.twilio.com] - Insights WebSocket gateway url\n * @property {number} [maxReconnectAttempts=5] - Max re-connect attempts\n * @property {number} [reconnectIntervalMs=50] - Re-connect interval in ms\n */\n\nmodule.exports = InsightsPublisher;\n"],"mappings":"AAAA;AACA,YAAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEZ,IAAMA,YAAY,GAAGC,OAAO,CAAC,QAAQ,CAAC,CAACD,YAAY;AAE3C,IAAAE,YAAY,GAAKD,OAAO,CAAC,IAAI,CAAC,CAAAC,YAAlB;AAEpB,IAAMC,sBAAsB,GAAG,CAAC;AAChC,IAAMC,qBAAqB,GAAG,EAAE;AAChC,IAAMC,eAAe,GAAG,IAAI;AAE5B,IAAMC,QAAQ,GAAGC,UAAU;AAC3B,IAAMC,SAAS,GAAGF,QAAQ,CAACE,SAAS,GAAGF,QAAQ,CAACE,SAAS,GAAGP,OAAO,CAAC,IAAI,CAAC;AACnE,IAAAQ,EAAA,GAAiER,OAAO,CAAC,cAAc,CAAC;EAAtFS,2BAA2B,GAAAD,EAAA,CAAAC,2BAAA;EAAEC,6BAA6B,GAAAF,EAAA,CAAAE,6BAA4B;AAC9F,IAAMC,IAAI,GAAGX,OAAO,CAAC,YAAY,CAAC;AAClC,IAAMY,gBAAgB,GAAGZ,OAAO,CAAC,qBAAqB,CAAC;AAEvD;;;;;;;AAOA,IAAAa,iBAAA,0BAAAC,MAAA;EAAgCC,SAAA,CAAAF,iBAAA,EAAAC,MAAA;EAC9B;;;;;;;;EAQA,SAAAD,kBAAYG,KAAK,EAAEC,OAAO,EAAEC,UAAU,EAAEC,WAAW,EAAEC,KAAK,EAAEC,OAAO;IAAnE,IAAAC,KAAA,GACER,MAAA,CAAAS,IAAA,MAAO;IAEPF,OAAO,GAAGG,MAAM,CAACC,MAAM,CAAC;MACtBC,OAAO,EAAKC,aAAa,CAACR,WAAW,EAAEC,KAAK,CAAC,oBAAiB;MAC9DQ,oBAAoB,EAAE1B,sBAAsB;MAC5C2B,mBAAmB,EAAE1B,qBAAqB;MAC1C2B,SAAS,EAAE7B,YAAY,EAAE;MACzBM,SAAS,EAAAA;KACV,EAAEc,OAAO,CAAC;IAEXG,MAAM,CAACO,gBAAgB,CAACT,KAAI,EAAE;MAC5BU,iBAAiB,EAAE;QACjBC,KAAK,EAAE,CAAC;QACRC,QAAQ,EAAE;OACX;MACDC,WAAW,EAAE;QACXF,KAAK,EAAE;OACR;MACDG,eAAe,EAAE;QACfH,KAAK,EAAEtB,IAAI,CAAC0B,KAAK;OAClB;MACDC,sBAAsB,EAAE;QACtBL,KAAK,EAAEZ,OAAO,CAACO,oBAAoB;QACnCM,QAAQ,EAAE;OACX;MACDK,GAAG,EAAE;QACHN,KAAK,EAAE,IAAI;QACXC,QAAQ,EAAE;OACX;MACDM,UAAU,EAAE;QACVP,KAAK,EAAEZ,OAAO,CAACd;;KAElB,CAAC;IAEFe,KAAI,CAACc,eAAe,CAACK,OAAO,CAACC,IAAI,CAAC,UAAClC,EAA2B;UAAzBmC,OAAO,GAAAnC,EAAA,CAAAmC,OAAA;QAAEC,cAAc,GAAApC,EAAA,CAAAoC,cAAA;MAC1D,IAAMC,IAAI,GAAGvB,KAAI;MACjBA,KAAI,CAACwB,EAAE,CAAC,cAAc,EAAE,SAASC,cAAcA,CAACC,KAAK;QACnDH,IAAI,CAACI,QAAQ,GAAG,IAAI;QACpB,IAAID,KAAK,IAAIH,IAAI,CAACP,sBAAsB,GAAG,CAAC,EAAE;UAC5CO,IAAI,CAACK,IAAI,CAAC,cAAc,CAAC;UACzBC,SAAS,CAACN,IAAI,EAAE7B,KAAK,EAAEC,OAAO,EAAEC,UAAU,EAAEyB,OAAO,EAAEC,cAAc,EAAEvB,OAAO,CAAC;UAC7E;;QAEFwB,IAAI,CAACO,cAAc,CAAC,cAAc,EAAEL,cAAc,CAAC;MACrD,CAAC,CAAC;MACFM,OAAO,CAAC/B,KAAI,EAAEN,KAAK,EAAEC,OAAO,EAAEC,UAAU,EAAEyB,OAAO,EAAEC,cAAc,EAAEvB,OAAO,CAAC;IAC7E,CAAC,CAAC,CAACiC,KAAK,CAAC;MACP;IAAA,CACD,CAAC;;EACJ;EAEA;;;;;;EAMAzC,iBAAA,CAAA0C,SAAA,CAAAF,OAAO,GAAP,UAAQV,OAAO,EAAEC,cAAc;IAC7B,IAAI,CAACR,eAAe,CAACoB,OAAO,CAAC;MAAEb,OAAO,EAAAA,OAAA;MAAEC,cAAc,EAAAA;IAAA,CAAE,CAAC;EAC3D,CAAC;EAED;;;;;EAKA/B,iBAAA,CAAA0C,SAAA,CAAAE,QAAQ,GAAR,UAASC,KAAK;IACZA,KAAK,CAACC,OAAO,GAAG,IAAI,CAACV,QAAQ;IAC7B,IAAI,CAACV,GAAG,CAACqB,IAAI,CAACC,IAAI,CAACC,SAAS,CAACJ,KAAK,CAAC,CAAC;EACtC,CAAC;EAED;;;;EAIA7C,iBAAA,CAAA0C,SAAA,CAAAQ,UAAU,GAAV;IACE,IAAI,IAAI,CAACxB,GAAG,KAAK,IAAI,IAChB,IAAI,CAACA,GAAG,CAACyB,UAAU,KAAK,IAAI,CAACxB,UAAU,CAACyB,OAAO,IAC/C,IAAI,CAAC1B,GAAG,CAACyB,UAAU,KAAK,IAAI,CAACxB,UAAU,CAAC0B,MAAM,EAAE;MACnD,OAAO,KAAK;;IAGd,IAAI;MACF,IAAI,CAAC3B,GAAG,CAAC4B,KAAK,EAAE;KACjB,CAAC,OAAOnB,KAAK,EAAE;MACd;IAAA;IAEF,IAAI,CAACE,IAAI,CAAC,cAAc,CAAC;IAEzB,OAAO,IAAI;EACb,CAAC;EAED;;;;;;;EAOArC,iBAAA,CAAA0C,SAAA,CAAAa,OAAO,GAAP,UAAQC,SAAS,EAAEC,SAAS,EAAEC,OAAO;IACnC,IAAI,IAAI,CAAChC,GAAG,KAAK,IAAI,KACf,IAAI,CAACA,GAAG,CAACyB,UAAU,KAAK,IAAI,CAACxB,UAAU,CAACyB,OAAO,IAC9C,IAAI,CAAC1B,GAAG,CAACyB,UAAU,KAAK,IAAI,CAACxB,UAAU,CAAC0B,MAAM,CAAC,EAAE;MACtD,OAAO,KAAK;;IAGd,IAAMM,gBAAgB,GAAG,OAAO,IAAI,CAACvB,QAAQ,KAAK,QAAQ,GACtD,IAAI,CAACQ,QAAQ,CAACgB,IAAI,CAAC,IAAI,CAAC,GACxB,IAAI,CAACtC,WAAW,CAACuC,IAAI,CAACD,IAAI,CAAC,IAAI,CAACtC,WAAW,CAAC;IAEhDqC,gBAAgB,CAAC;MACfG,KAAK,EAAEN,SAAS;MAChBO,IAAI,EAAEN,SAAS;MACfC,OAAO,EAAAA,OAAA;MACPM,SAAS,EAAEC,IAAI,CAACC,GAAG,EAAE;MACrBC,IAAI,EAAE,OAAO;MACbC,OAAO,EAAE;KACV,CAAC;IAEF,OAAO,IAAI;EACb,CAAC;EACH,OAAApE,iBAAC;AAAD,CAAC,CAnI+Bd,YAAY;AAqI5C;;;;;;;;;;;;AAYA,SAASsD,OAAOA,CAAC6B,SAAS,EAAElE,KAAK,EAAEC,OAAO,EAAEC,UAAU,EAAEyB,OAAO,EAAEC,cAAc,EAAEvB,OAAO;EACtF6D,SAAS,CAAClD,iBAAiB,GAAG8C,IAAI,CAACC,GAAG,EAAE;EACxCG,SAAS,CAAC5C,sBAAsB,EAAE;EAClC4C,SAAS,CAAC3C,GAAG,GAAG,IAAIlB,OAAO,CAACd,SAAS,CAACc,OAAO,CAACK,OAAO,CAAC;EACtD,IAAMyD,EAAE,GAAGD,SAAS,CAAC3C,GAAG;EAExB4C,EAAE,CAACC,gBAAgB,CAAC,OAAO,EAAE,UAAA1B,KAAK;IAChC,IAAIA,KAAK,CAAC2B,IAAI,KAAKjF,eAAe,EAAE;MAClC8E,SAAS,CAAChC,IAAI,CAAC,cAAc,CAAC;MAC9B;;IAEFgC,SAAS,CAAChC,IAAI,CAAC,cAAc,EAAE,IAAIoC,KAAK,CAAC,qBAAmB5B,KAAK,CAAC2B,IAAI,UAAK3B,KAAK,CAAC6B,MAAQ,CAAC,CAAC;EAC7F,CAAC,CAAC;EAEFJ,EAAE,CAACC,gBAAgB,CAAC,SAAS,EAAE,UAAAI,OAAO;IACpCC,qBAAqB,CAACP,SAAS,EAAErB,IAAI,CAAC6B,KAAK,CAACF,OAAO,CAACG,IAAI,CAAC,EAAEtE,OAAO,CAAC;EACrE,CAAC,CAAC;EAEF8D,EAAE,CAACC,gBAAgB,CAAC,MAAM,EAAE;IAC1B,IAAMQ,cAAc,GAAG;MACrBZ,IAAI,EAAE,SAAS;MACfhE,KAAK,EAAAA,KAAA;MACLiE,OAAO,EAAE;KACV;IAEDW,cAAc,CAACV,SAAS,GAAG;MACzBN,IAAI,EAAE3D,OAAO;MACbC,UAAU,EAAAA,UAAA;MACVY,SAAS,EAAET,OAAO,CAACS,SAAS;MAC5Bc,cAAc,EAAEA,cAAc;MAC9BD,OAAO,EAAEA;KACV;IAED,IAAI/B,gBAAgB,CAACiF,MAAM,EAAE,EAAE;MAC7BD,cAAc,CAACV,SAAS,GAAAY,QAAA,CAAAA,QAAA,KAAQF,cAAc,CAACV,SAAS,GAAKzE,2BAA2B,CAAE;KAC3F,MAAM,IAAIG,gBAAgB,CAACmF,QAAQ,EAAE,EAAE;MACtCH,cAAc,CAACV,SAAS,GAAAY,QAAA,CAAAA,QAAA,KAAQF,cAAc,CAACV,SAAS,GAAKxE,6BAA6B,CAAE;;IAG9FyE,EAAE,CAACvB,IAAI,CAACC,IAAI,CAACC,SAAS,CAAC8B,cAAc,CAAC,CAAC;EACzC,CAAC,CAAC;AACJ;AAEA;;;;;;AAMA,SAASjE,aAAaA,CAACR,WAAW,EAAEC,KAAK;EACvC,OAAOD,WAAW,KAAK,MAAM,GAAG,iBAAeC,KAAK,gBAAa,GAC7D,iBAAeD,WAAW,SAAIC,KAAK,gBAAa;AACtD;AAEA;;;;;;AAMA,SAASqE,qBAAqBA,CAACP,SAAS,EAAEc,QAAQ,EAAE3E,OAAO;EACzD,QAAQ2E,QAAQ,CAAChB,IAAI;IACnB,KAAK,WAAW;MACdE,SAAS,CAACjC,QAAQ,GAAG+C,QAAQ,CAACrC,OAAO;MACrCuB,SAAS,CAAC5C,sBAAsB,GAAGjB,OAAO,CAACO,oBAAoB;MAC/DsD,SAAS,CAAC/C,WAAW,CAAC8D,MAAM,CAAC,CAAC,CAAC,CAACC,OAAO,CAAChB,SAAS,CAACzB,QAAQ,EAAEyB,SAAS,CAAC;MACtEA,SAAS,CAAChC,IAAI,CAAC,WAAW,CAAC;MAC3B;IACF,KAAK,OAAO;MACVgC,SAAS,CAAC3C,GAAG,CAAC4B,KAAK,EAAE;MACrBe,SAAS,CAAChC,IAAI,CAAC,cAAc,EAAE,IAAIoC,KAAK,CAACU,QAAQ,CAACR,OAAO,CAAC,CAAC;MAC3D;;AAEN;AAEA;;;;;;;;;;;;AAYA,SAASrC,SAASA,CAAC+B,SAAS,EAAElE,KAAK,EAAEC,OAAO,EAAEC,UAAU,EAAEyB,OAAO,EAAEC,cAAc,EAAEvB,OAAO;EACxF,IAAM8E,eAAe,GAAGrB,IAAI,CAACC,GAAG,EAAE,GAAGG,SAAS,CAAClD,iBAAiB;EAChE,IAAMoE,UAAU,GAAG/E,OAAO,CAACQ,mBAAmB,GAAGsE,eAAe;EAEhE,IAAIC,UAAU,GAAG,CAAC,EAAE;IAClBC,UAAU,CAAC;MACThD,OAAO,CAAC6B,SAAS,EAAElE,KAAK,EAAEC,OAAO,EAAEC,UAAU,EAAEyB,OAAO,EAAEC,cAAc,EAAEvB,OAAO,CAAC;IAClF,CAAC,EAAE+E,UAAU,CAAC;IACd;;EAGF/C,OAAO,CAAC6B,SAAS,EAAElE,KAAK,EAAEC,OAAO,EAAEC,UAAU,EAAEyB,OAAO,EAAEC,cAAc,EAAEvB,OAAO,CAAC;AAClF;AAEA;;;;AAKA;;;;;AAMA;;;;AAKA;;;;;;;AAQAiF,MAAM,CAACC,OAAO,GAAG1F,iBAAiB"},"metadata":{},"sourceType":"script","externalDependencies":[]}